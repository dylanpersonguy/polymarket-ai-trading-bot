<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polymarket Bot ‚Äî Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="/static/style.css?v=4">
</head>
<body>
    <!-- ‚îÄ‚îÄ‚îÄ Toast Container ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div id="toast-container"></div>

    <!-- ‚îÄ‚îÄ‚îÄ Confirmation Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div id="modal-overlay" class="modal-overlay" style="display:none;">
        <div class="modal-box">
            <h3 id="modal-title">Confirm Action</h3>
            <p id="modal-message">Are you sure?</p>
            <div class="modal-actions">
                <button class="btn btn-muted" onclick="closeModal()">Cancel</button>
                <button class="btn btn-danger" id="modal-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <header>
        <div class="header-left">
            <h1>üìä Polymarket Bot</h1>
            <span class="subtitle">Research & Trading Dashboard</span>
        </div>
        <div class="header-right">
            <span id="engine-badge" class="badge badge-paper" style="display:none;">ENGINE OFF</span>
            <span id="mode-badge" class="badge badge-paper">PAPER MODE</span>
            <span id="kill-switch-badge" class="badge badge-ok" style="display:none;">KILL SWITCH</span>
            <span class="last-updated">Updated: <span id="last-updated-time">‚Äî</span></span>
        </div>
    </header>

    <!-- ‚îÄ‚îÄ‚îÄ Portfolio Overview Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="card-grid" id="portfolio-cards">
        <div class="card accent-blue">
            <div class="card-label">Bankroll</div>
            <div class="card-value" id="bankroll">$0.00</div>
            <div class="card-sub" id="available-capital">Available: $0.00</div>
        </div>
        <div class="card accent-green">
            <div class="card-label">Total P&L</div>
            <div class="card-value" id="total-pnl">$0.00</div>
            <div class="card-sub" id="unrealized-pnl">Unrealized: $0.00</div>
        </div>
        <div class="card accent-purple">
            <div class="card-label">Open Positions</div>
            <div class="card-value" id="open-positions">0</div>
            <div class="card-sub" id="total-invested">Invested: $0.00</div>
        </div>
        <div class="card accent-orange">
            <div class="card-label">Total Trades</div>
            <div class="card-value" id="total-trades">0</div>
            <div class="card-sub" id="trade-breakdown">Live: 0 | Paper: 0</div>
        </div>
        <div class="card accent-teal">
            <div class="card-label">Avg Edge</div>
            <div class="card-value" id="avg-edge">0.00%</div>
            <div class="card-sub" id="avg-evidence-quality">Avg EQ: 0.000</div>
        </div>
        <div class="card accent-pink">
            <div class="card-label">Today's Activity</div>
            <div class="card-value" id="today-trades">0 trades</div>
            <div class="card-sub" id="daily-volume">Volume: $0.00</div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Charts Row ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="charts-row">
        <div class="chart-container">
            <h3>üìà Daily Forecasts & Trades</h3>
            <canvas id="chart-daily-activity"></canvas>
        </div>
        <div class="chart-container">
            <h3>üéØ Edge & Evidence Quality</h3>
            <canvas id="chart-edge-eq"></canvas>
        </div>
        <div class="chart-container chart-small">
            <h3>üè∑Ô∏è Market Types</h3>
            <canvas id="chart-market-types"></canvas>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Equity Curve ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="charts-row charts-row-single">
        <div class="chart-container chart-wide">
            <h3>üí∞ Equity Curve (Cumulative P&L)</h3>
            <canvas id="chart-equity-curve"></canvas>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Risk Monitor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <h2>‚ö†Ô∏è Risk Monitor</h2>
        <div class="risk-grid" id="risk-grid">
            <div class="risk-item">
                <div class="risk-label">Daily Exposure</div>
                <div class="risk-bar-container">
                    <div class="risk-bar" id="risk-bar-daily" style="width:0%"></div>
                </div>
                <div class="risk-values">
                    <span id="risk-daily-current">$0</span> / <span id="risk-daily-limit">$0</span>
                </div>
            </div>
            <div class="risk-item">
                <div class="risk-label">Open Positions</div>
                <div class="risk-bar-container">
                    <div class="risk-bar" id="risk-bar-positions" style="width:0%"></div>
                </div>
                <div class="risk-values">
                    <span id="risk-pos-current">0</span> / <span id="risk-pos-limit">0</span>
                </div>
            </div>
            <div class="risk-item">
                <div class="risk-label">Evidence Quality (recent avg)</div>
                <div class="risk-bar-container">
                    <div class="risk-bar bar-inverted" id="risk-bar-eq" style="width:0%"></div>
                </div>
                <div class="risk-values">
                    <span id="risk-eq-current">0.00</span> / min <span id="risk-eq-limit">0.00</span>
                </div>
            </div>
        </div>
        <div class="risk-params" id="risk-params"></div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Engine & Drawdown Status ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="card-grid" id="engine-cards">
        <div class="card accent-teal">
            <div class="card-label">Engine Status</div>
            <div class="card-value" id="engine-status">OFF</div>
            <div class="card-sub" id="engine-cycles">Cycles: 0</div>
        </div>
        <div class="card accent-pink">
            <div class="card-label">Drawdown</div>
            <div class="card-value" id="drawdown-pct">0.0%</div>
            <div class="card-sub" id="drawdown-detail">Peak: $0 | Current: $0</div>
        </div>
        <div class="card accent-purple">
            <div class="card-label">Heat Level</div>
            <div class="card-value" id="heat-level">üü¢ Cool</div>
            <div class="card-sub" id="kelly-mult">Kelly multiplier: 1.0x</div>
        </div>
        <div class="card accent-orange">
            <div class="card-label">Kill Switch</div>
            <div class="card-value" id="kill-switch-status">OFF</div>
            <div class="card-sub">
                <button class="btn btn-danger" id="btn-kill-on" onclick="confirmKillSwitch(true)">Activate</button>
                <button class="btn btn-ok" id="btn-kill-off" onclick="confirmKillSwitch(false)" style="display:none;">Deactivate</button>
            </div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Active Positions ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <div class="panel-header">
            <h2>üíº Active Positions</h2>
            <div class="panel-tools">
                <input type="text" class="search-input" placeholder="üîç Filter positions..." oninput="filterTable('positions-body', this.value)">
                <button class="btn btn-export" onclick="exportData('positions')">üì• Export</button>
            </div>
        </div>
        <div class="table-wrap">
            <table id="positions-table">
                <thead><tr>
                    <th>Market</th><th>Type</th><th>Direction</th><th>Entry</th><th>Current</th>
                    <th>Size</th><th>Stake</th><th>P&L</th><th>P&L %</th><th>Opened</th>
                </tr></thead>
                <tbody id="positions-body">
                    <tr><td colspan="10" class="empty-state">No active positions</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Pipeline Candidates Log ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <div class="panel-header">
            <h2>üî¨ Pipeline Candidates</h2>
            <div class="panel-tools">
                <input type="text" class="search-input" placeholder="üîç Filter candidates..." oninput="filterTable('candidates-body', this.value)">
            </div>
        </div>
        <div class="table-wrap">
            <table id="candidates-table">
                <thead><tr>
                    <th>Cycle</th><th>Market</th><th>Type</th><th>Implied P</th><th>Model P</th>
                    <th>Edge</th><th>EQ</th><th>Sources</th><th>Confidence</th>
                    <th>Decision</th><th>Stake</th><th>Reason</th><th>Time</th>
                </tr></thead>
                <tbody id="candidates-body">
                    <tr><td colspan="13" class="empty-state">No candidates processed yet</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Decision Intelligence Log ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="decision-log-panel">
        <div class="panel-header">
            <h2>üß† Decision Intelligence Log</h2>
            <div class="panel-tools">
                <select id="decision-cycle-filter" class="search-input" style="width:160px;" onchange="updateDecisionLog()">
                    <option value="">All Cycles</option>
                </select>
                <select id="decision-filter" class="search-input" style="width:140px;" onchange="filterDecisionCards()">
                    <option value="">All Decisions</option>
                    <option value="TRADE">‚úÖ Trade</option>
                    <option value="NO TRADE">‚ùå No Trade</option>
                    <option value="SKIP">‚è≠Ô∏è Skip</option>
                </select>
                <button class="btn btn-export btn-sm" onclick="toggleDecisionExpand()" id="btn-expand-all">Expand All</button>
            </div>
        </div>
        <div id="decision-log-container">
            <div class="empty-state" style="padding:40px 0;">No decision data yet ‚Äî run an engine cycle to see how the bot makes decisions.</div>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Recent Forecasts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <div class="panel-header">
            <h2>üîÆ Recent Forecasts</h2>
            <div class="panel-tools">
                <input type="text" class="search-input" placeholder="üîç Filter forecasts..." oninput="filterTable('forecasts-body', this.value)">
                <button class="btn btn-export" onclick="exportData('forecasts')">üì• Export</button>
            </div>
        </div>
        <div class="table-wrap">
            <table id="forecasts-table">
                <thead><tr>
                    <th>Market</th><th>Type</th><th>Implied P</th><th>Model P</th><th>Edge</th>
                    <th>EQ</th><th>Sources</th><th>Confidence</th><th>Decision</th><th>Time</th>
                </tr></thead>
                <tbody id="forecasts-body">
                    <tr><td colspan="10" class="empty-state">No forecasts yet</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Trade History ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <div class="panel-header">
            <h2>üìú Trade History</h2>
            <div class="panel-tools">
                <input type="text" class="search-input" placeholder="üîç Filter trades..." oninput="filterTable('trades-body', this.value)">
                <button class="btn btn-export" onclick="exportData('trades')">üì• Export</button>
            </div>
        </div>
        <div class="table-wrap">
            <table id="trades-table">
                <thead><tr>
                    <th>Market</th><th>Type</th><th>Side</th><th>Price</th><th>Size</th>
                    <th>Stake</th><th>Status</th><th>Mode</th><th>Time</th>
                </tr></thead>
                <tbody id="trades-body">
                    <tr><td colspan="9" class="empty-state">No trades yet</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Audit Log ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <div class="panel-header">
            <h2>üîí Audit Trail</h2>
            <div class="panel-tools">
                <input type="text" class="search-input" placeholder="üîç Filter audit..." oninput="filterTable('audit-body', this.value)">
            </div>
        </div>
        <div class="table-wrap">
            <table id="audit-table">
                <thead><tr>
                    <th>ID</th><th>Market</th><th>Decision</th><th>Stage</th>
                    <th>Details</th><th>Integrity</th><th>Time</th>
                </tr></thead>
                <tbody id="audit-body">
                    <tr><td colspan="7" class="empty-state">No audit entries</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Recent Alerts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel">
        <h2>üîî Recent Alerts</h2>
        <div class="table-wrap">
            <table id="alerts-table">
                <thead><tr>
                    <th>Level</th><th>Channel</th><th>Message</th><th>Time</th>
                </tr></thead>
                <tbody id="alerts-body">
                    <tr><td colspan="4" class="empty-state">No alerts</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ System Config (Editable) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <section class="panel" id="config-panel">
        <div class="panel-header">
            <h2>‚öôÔ∏è Configuration</h2>
            <div class="panel-tools">
                <button class="btn btn-save" onclick="saveAllConfig()">üíæ Save All Changes</button>
                <button class="btn btn-muted" onclick="confirmResetConfig()">üîÑ Reset Defaults</button>
            </div>
        </div>
        <p class="config-hint">Edit any value below and click <strong>Save All Changes</strong> to persist to config.yaml. Changes take effect immediately.</p>
        <div class="config-tabs" id="config-tabs"></div>
        <div class="config-grid" id="config-grid"></div>
    </section>

    <!-- ‚îÄ‚îÄ‚îÄ Footer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <footer>
        <span>Polymarket Research & Trading Bot ‚Äî Dashboard</span>
        <span>Auto-refreshes every 15s</span>
    </footer>

    <script src="/static/dashboard.js?v=4"></script>
</body>
</html>
