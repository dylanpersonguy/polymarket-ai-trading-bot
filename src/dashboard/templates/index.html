<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0f1117">
    <title>Polymarket Bot â€” Dashboard</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="/static/style.css?v=38">
</head>
<body>
    <!-- â”€â”€â”€ Toast Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="toast-container"></div>

    <!-- â”€â”€â”€ Confirmation Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="modal-overlay" class="modal-overlay" style="display:none;">
        <div class="modal-box">
            <h3 id="modal-title">Confirm Action</h3>
            <p id="modal-message">Are you sure?</p>
            <div class="modal-actions">
                <button class="btn btn-muted" onclick="closeModal()">Cancel</button>
                <button class="btn btn-danger" id="modal-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- â”€â”€â”€ Position Detail Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="position-detail-overlay" class="modal-overlay" style="display:none;" onclick="closePositionDetail(event)">
        <div class="pos-detail-box" onclick="event.stopPropagation()">
            <div class="pos-detail-header">
                <div class="pos-detail-title-row">
                    <h3 id="pos-detail-question">â€”</h3>
                    <button class="pos-detail-close" onclick="closePositionDetail()">&times;</button>
                </div>
                <div class="pos-detail-badges" id="pos-detail-badges"></div>
            </div>
            <div class="pos-detail-body" id="pos-detail-body">
                <div class="pos-detail-loading">Loading position dataâ€¦</div>
            </div>
            <div class="pos-detail-footer" id="pos-detail-footer"></div>
        </div>
    </div>

    <!-- â”€â”€â”€ Trade Detail Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="trade-detail-overlay" class="modal-overlay" style="display:none;" onclick="closeTradeDetail(event)">
        <div class="trade-detail-box" onclick="event.stopPropagation()">
            <div class="td-header">
                <div class="td-title-row">
                    <h3 id="td-question">â€”</h3>
                    <button class="pos-detail-close" onclick="closeTradeDetail()">&times;</button>
                </div>
                <div class="td-badges" id="td-badges"></div>
            </div>
            <div class="td-body" id="td-body">
                <div class="pos-detail-loading">Loading trade dataâ€¦</div>
            </div>
            <div class="td-footer" id="td-footer"></div>
        </div>
    </div>

    <!-- â”€â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <header>
        <div class="header-left">
            <h1>ğŸ“Š Polymarket Bot</h1>
            <span class="subtitle">Research & Trading Dashboard</span>
        </div>
        <div class="header-right">
            <span id="engine-badge" class="badge badge-paper" style="display:none;">ENGINE OFF</span>
            <span id="mode-badge" class="badge badge-paper">PAPER MODE</span>
            <span id="kill-switch-badge" class="badge badge-ok" style="display:none;">KILL SWITCH</span>
            <span class="last-updated">Updated: <span id="last-updated-time">â€”</span></span>
            <button class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" title="Toggle theme"></button>
        </div>
    </header>

    <!-- â”€â”€â”€ Tab Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <nav class="tab-nav" id="tab-nav">
        <button class="tab-btn active" data-tab="overview" onclick="switchTab('overview')">
            <span class="tab-icon">ğŸ“Š</span>
            <span class="tab-label">Overview</span>
        </button>
        <button class="tab-btn" data-tab="trading" onclick="switchTab('trading')">
            <span class="tab-icon">ğŸ’¼</span>
            <span class="tab-label">Trading</span>
        </button>
        <button class="tab-btn" data-tab="analytics" onclick="switchTab('analytics')">
            <span class="tab-icon">ğŸ“ˆ</span>
            <span class="tab-label">Analytics</span>
        </button>
        <button class="tab-btn" data-tab="whales" onclick="switchTab('whales')">
            <span class="tab-icon">ğŸ‹</span>
            <span class="tab-label">Whale Tracker</span>
        </button>
        <button class="tab-btn" data-tab="decisions" onclick="switchTab('decisions')">
            <span class="tab-icon">ğŸ§ </span>
            <span class="tab-label">Decision Intel</span>
        </button>
        <button class="tab-btn" data-tab="strategies" onclick="switchTab('strategies')">
            <span class="tab-icon">ğŸ¯</span>
            <span class="tab-label">Strategies</span>
        </button>
        <button class="tab-btn" data-tab="journal" onclick="switchTab('journal')">
            <span class="tab-icon">ğŸ““</span>
            <span class="tab-label">Journal</span>
        </button>
        <button class="tab-btn" data-tab="admin" onclick="switchTab('admin')">
            <span class="tab-icon">ğŸ›¡ï¸</span>
            <span class="tab-label">Admin Panel</span>
        </button>
        <button class="tab-btn" data-tab="docs" onclick="switchTab('docs')">
            <span class="tab-icon">ğŸ“–</span>
            <span class="tab-label">Documentation</span>
        </button>
    </nav>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB 1: OVERVIEW                                         -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content active" id="tab-overview" data-tab="overview">

        <!-- â”€â”€â”€ Portfolio Overview Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card-grid" id="portfolio-cards">
            <div class="card accent-blue">
                <div class="card-label">Bankroll</div>
                <div class="card-value" id="bankroll">$0.00</div>
                <div class="card-sub" id="available-capital">Available: $0.00</div>
            </div>
            <div class="card accent-green">
                <div class="card-label">Total P&L</div>
                <div class="card-value" id="total-pnl">$0.00</div>
                <div class="card-sub" id="unrealized-pnl">Unrealized: $0.00</div>
            </div>
            <div class="card accent-purple">
                <div class="card-label">Open Positions</div>
                <div class="card-value" id="open-positions">0</div>
                <div class="card-sub" id="total-invested">Invested: $0.00</div>
            </div>
            <div class="card accent-orange">
                <div class="card-label">Total Trades</div>
                <div class="card-value" id="total-trades">0</div>
                <div class="card-sub" id="trade-breakdown">Live: 0 | Paper: 0</div>
            </div>
            <div class="card accent-teal">
                <div class="card-label">Avg Edge</div>
                <div class="card-value" id="avg-edge">0.00%</div>
                <div class="card-sub" id="avg-evidence-quality">Avg EQ: 0.000</div>
            </div>
            <div class="card accent-pink">
                <div class="card-label">Today's Activity</div>
                <div class="card-value" id="today-trades">0 trades</div>
                <div class="card-sub" id="daily-volume">Volume: $0.00</div>
            </div>
        </section>

        <!-- â”€â”€â”€ Charts Row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="charts-row">
            <div class="chart-container">
                <h3>ğŸ“ˆ Daily Forecasts & Trades</h3>
                <canvas id="chart-daily-activity"></canvas>
            </div>
            <div class="chart-container">
                <h3>ğŸ¯ Edge & Evidence Quality</h3>
                <canvas id="chart-edge-eq"></canvas>
            </div>
            <div class="chart-container chart-small">
                <h3>ğŸ·ï¸ Market Types</h3>
                <canvas id="chart-market-types"></canvas>
            </div>
        </section>

        <!-- â”€â”€â”€ Equity Curve â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="charts-row charts-row-single">
            <div class="chart-container chart-wide">
                <h3>ğŸ’° Equity Curve (Cumulative P&L)</h3>
                <canvas id="chart-equity-curve"></canvas>
            </div>
        </section>

        <!-- â”€â”€â”€ Engine & Drawdown Status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card-grid" id="engine-cards">
            <div class="card accent-teal">
                <div class="card-label">Engine Status</div>
                <div class="card-value" id="engine-status">OFF</div>
                <div class="card-sub" id="engine-cycles">Cycles: 0</div>
                <div class="card-sub" style="margin-top:6px;">
                    <button class="btn btn-ok" id="btn-engine-start" onclick="toggleEngine(true)" style="font-size:0.75rem;">â–¶ Start</button>
                    <button class="btn btn-danger" id="btn-engine-stop" onclick="toggleEngine(false)" style="font-size:0.75rem;display:none;">â¹ Stop</button>
                </div>
            </div>
            <div class="card accent-pink">
                <div class="card-label">Drawdown</div>
                <div class="card-value" id="drawdown-pct">0.0%</div>
                <div class="card-sub" id="drawdown-detail">Peak: $0 | Current: $0</div>
            </div>
            <div class="card accent-purple">
                <div class="card-label">Heat Level</div>
                <div class="card-value" id="heat-level">ğŸŸ¢ Cool</div>
                <div class="card-sub" id="kelly-mult">Kelly multiplier: 1.0x</div>
            </div>
            <div class="card accent-orange">
                <div class="card-label">Kill Switch</div>
                <div class="card-value" id="kill-switch-status">OFF</div>
                <div class="card-sub">
                    <button class="btn btn-danger" id="btn-kill-on" onclick="confirmKillSwitch(true)">Activate</button>
                    <button class="btn btn-ok" id="btn-kill-off" onclick="confirmKillSwitch(false)" style="display:none;">Deactivate</button>
                </div>
            </div>
        </section>

        <!-- â”€â”€â”€ Market Regime â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel" id="regime-panel">
            <div class="panel-header">
                <h2>ğŸŒ¡ï¸ Market Regime</h2>
            </div>
            <div class="card-grid" id="regime-cards">
                <div class="card accent-blue">
                    <div class="card-label">Current Regime</div>
                    <div class="card-value" id="regime-current">NORMAL</div>
                    <div class="card-sub" id="regime-confidence">Confidence: â€”</div>
                </div>
                <div class="card accent-green">
                    <div class="card-label">Kelly Multiplier</div>
                    <div class="card-value" id="regime-kelly">1.00x</div>
                    <div class="card-sub" id="regime-size-mult">Size: 1.00x</div>
                </div>
                <div class="card accent-purple">
                    <div class="card-label">Regime Explanation</div>
                    <div class="card-value" id="regime-explanation" style="font-size:0.85rem;line-height:1.4;">â€”</div>
                    <div class="card-sub" id="regime-detected-at">â€”</div>
                </div>
            </div>
        </section>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB 2: TRADING                                          -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-trading" data-tab="trading">

        <!-- â”€â”€â”€ Active Positions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ï¿½ Active Positions</h2>
                <div class="panel-tools">
                    <input type="text" class="search-input" placeholder="ğŸ” Filter positions..." oninput="filterTable('positions-body', this.value)">
                    <button class="btn btn-export" onclick="exportData('positions')">ğŸ“¥ Export</button>
                </div>
            </div>
            <div id="positions-summary"></div>
            <div class="table-wrap">
                <table id="positions-table">
                    <thead><tr>
                        <th>Market</th><th>Type</th><th>Direction</th><th>Entry</th><th>Current</th>
                        <th>Size</th><th>Stake</th><th>P&L</th><th>P&L %</th><th>Î” Price</th><th>Held</th>
                    </tr></thead>
                    <tbody id="positions-body">
                        <tr><td colspan="11" class="empty-state">No active positions</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Pipeline Candidates Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ”¬ Pipeline Candidates</h2>
                <div class="panel-tools">
                    <input type="text" class="search-input" placeholder="ğŸ” Filter candidates..." oninput="filterTable('candidates-body', this.value)">
                </div>
            </div>
            <div class="table-wrap">
                <table id="candidates-table">
                    <thead><tr>
                        <th>Cycle</th><th>Market</th><th>Type</th><th>Implied P</th><th>Model P</th>
                        <th>Edge</th><th>EQ</th><th>Sources</th><th>Confidence</th>
                        <th>Decision</th><th>Stake</th><th>Reason</th><th>Time</th>
                    </tr></thead>
                    <tbody id="candidates-body">
                        <tr><td colspan="13" class="empty-state">No candidates processed yet</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Recent Forecasts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ”® Recent Forecasts</h2>
                <div class="panel-tools">
                    <input type="text" class="search-input" placeholder="ğŸ” Filter forecasts..." oninput="filterTable('forecasts-body', this.value)">
                    <button class="btn btn-export" onclick="exportData('forecasts')">ğŸ“¥ Export</button>
                </div>
            </div>
            <div class="table-wrap">
                <table id="forecasts-table">
                    <thead><tr>
                        <th>Market</th><th>Type</th><th>Implied P</th><th>Model P</th><th>Edge</th>
                        <th>EQ</th><th>Sources</th><th>Confidence</th><th>Decision</th><th>Time</th>
                    </tr></thead>
                    <tbody id="forecasts-body">
                        <tr><td colspan="10" class="empty-state">No forecasts yet</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Trade History (Enhanced) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“œ Trade History</h2>
                <div class="panel-tools">
                    <select id="trade-filter-status" class="search-input" style="width:140px;" onchange="filterTradesByStatus()">
                        <option value="all">All Trades</option>
                        <option value="ACTIVE">ğŸŸ¢ Active</option>
                        <option value="TP_HIT">ğŸŸ¢ TP Hit</option>
                        <option value="SL_HIT">ğŸ”´ SL Hit</option>
                        <option value="RESOLVED">ğŸ“‹ Resolved</option>
                        <option value="TIME_EXIT">â° Time Exit</option>
                        <option value="CLOSED">Closed</option>
                    </select>
                    <input type="text" class="search-input" placeholder="ğŸ” Filter trades..." oninput="filterTable('trades-body', this.value)">
                    <button class="btn btn-export" onclick="exportData('trades')">ğŸ“¥ Export</button>
                </div>
            </div>

            <!-- Trade Summary Strip -->
            <div class="pnl-summary-strip" id="trades-summary" style="display:none;">
                <span class="summary-item" id="ts-total">Total: â€”</span>
                <span class="summary-item" id="ts-active" style="color:var(--accent-blue)">ğŸŸ¢ Active: â€”</span>
                <span class="summary-item" id="ts-closed">Closed: â€”</span>
                <span class="summary-item" id="ts-winrate">ğŸ¯ Win Rate: â€”</span>
                <span class="summary-item" id="ts-pnl">ğŸ’° P&L: â€”</span>
                <span class="summary-item" id="ts-tp">ğŸŸ¢ TP Hits: â€”</span>
                <span class="summary-item" id="ts-sl">ğŸ”´ SL Hits: â€”</span>
                <span class="summary-item" id="ts-avghold">â± Avg Hold: â€”</span>
                <span class="summary-item" id="ts-best">ğŸ† Best: â€”</span>
                <span class="summary-item" id="ts-worst">ğŸ“‰ Worst: â€”</span>
            </div>

            <div class="table-wrap">
                <table id="trades-table">
                    <thead><tr>
                        <th>Market</th><th>Direction</th><th>Entry</th><th>Exit / Current</th>
                        <th>Stake</th><th>P&L</th><th>P&L %</th><th>Status</th>
                        <th>Close Reason</th><th>Duration</th><th>Mode</th><th>Opened</th>
                    </tr></thead>
                    <tbody id="trades-body">
                        <tr><td colspan="12" class="empty-state">No trades yet</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB 3: ANALYTICS                                        -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-analytics" data-tab="analytics">

        <!-- â”€â”€â”€ Performance Analytics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel" id="analytics-panel">
            <div class="panel-header">
                <h2>ğŸ“Š Performance Analytics</h2>
            </div>

            <!-- Analytics KPI Cards -->
            <div class="card-grid analytics-cards" id="analytics-kpi-cards">
                <div class="card accent-green">
                    <div class="card-label">Win Rate</div>
                    <div class="card-value" id="ana-win-rate">â€”</div>
                    <div class="card-sub" id="ana-win-rate-sub">7d: â€” | 30d: â€”</div>
                </div>
                <div class="card accent-blue">
                    <div class="card-label">Sharpe Ratio</div>
                    <div class="card-value" id="ana-sharpe">â€”</div>
                    <div class="card-sub" id="ana-sortino-sub">Sortino: â€”</div>
                </div>
                <div class="card accent-purple">
                    <div class="card-label">Profit Factor</div>
                    <div class="card-value" id="ana-profit-factor">â€”</div>
                    <div class="card-sub" id="ana-pf-sub">Avg Win/Loss: â€”</div>
                </div>
                <div class="card accent-orange">
                    <div class="card-label">Max Drawdown</div>
                    <div class="card-value" id="ana-max-dd">â€”</div>
                    <div class="card-sub" id="ana-calmar-sub">Calmar: â€”</div>
                </div>
                <div class="card accent-teal">
                    <div class="card-label">ROI</div>
                    <div class="card-value" id="ana-roi">â€”</div>
                    <div class="card-sub" id="ana-roi-sub">Total Staked: â€”</div>
                </div>
                <div class="card accent-pink">
                    <div class="card-label">Streak</div>
                    <div class="card-value" id="ana-streak">â€”</div>
                    <div class="card-sub" id="ana-streak-sub">Best: â€” | Worst: â€”</div>
                </div>
            </div>

            <!-- Analytics Charts Row -->
            <div class="charts-row">
                <div class="chart-container">
                    <h3>ğŸ“Š Category P&L Breakdown</h3>
                    <canvas id="chart-category-pnl"></canvas>
                </div>
                <div class="chart-container">
                    <h3>ğŸ¯ Calibration Accuracy</h3>
                    <canvas id="chart-calibration"></canvas>
                </div>
                <div class="chart-container chart-small">
                    <h3>ğŸ¤– Model Accuracy</h3>
                    <canvas id="chart-model-accuracy"></canvas>
                </div>
            </div>

            <!-- Strategy Leaderboard -->
            <div class="table-wrap" style="margin-top:16px;">
                <h3 style="margin:0 0 8px 0;">ğŸ† Strategy Leaderboard</h3>
                <table id="leaderboard-table">
                    <thead><tr>
                        <th>Rank</th><th>Category</th><th>ROI %</th><th>Win Rate</th>
                        <th>Total P&L</th><th>Trades</th><th>Avg Edge</th><th>Score</th>
                    </tr></thead>
                    <tbody id="leaderboard-body">
                        <tr><td colspan="8" class="empty-state">No analytics data yet â€” resolved trades populate this view</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB 4: WHALE TRACKER (Enhanced)                         -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-whales" data-tab="whales">

        <section class="panel" id="whale-tracker-panel">
            <!-- â”€â”€â”€ Professional Toolbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-toolbar">
                <div class="whale-toolbar-left">
                    <h2 class="whale-title">ğŸ‹ Smart Money Terminal</h2>
                    <span class="whale-pulse" id="whale-pulse">â— LIVE</span>
                </div>
                <div class="whale-toolbar-right">
                    <span class="whale-toolbar-stat" id="whale-last-scan">Last scan: â€”</span>
                    <span class="whale-toolbar-divider">|</span>
                    <span class="whale-toolbar-stat" id="whale-scan-count">0 wallets</span>
                    <span class="whale-toolbar-divider">|</span>
                    <span class="whale-toolbar-stat whale-refresh-timer" id="whale-refresh-timer">âŸ³ 30s</span>
                    <button class="whale-btn-export" onclick="exportWhaleCSV()" title="Export to CSV">ğŸ“¥ Export</button>
                </div>
            </div>

            <!-- â”€â”€â”€ Risk Alert Ticker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-alert-ticker" id="whale-alert-ticker" style="display:none;">
                <div class="whale-alert-ticker-icon">âš ï¸</div>
                <div class="whale-alert-ticker-scroll" id="whale-alert-ticker-scroll"></div>
                <span class="whale-alert-ticker-count" id="whale-alert-ticker-count">0</span>
            </div>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- LIQUID MARKET WHALE SCANNER  (v4 â€“ Multi-Source Discovery)  -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <div class="whale-section-card scanner-master-panel" id="whale-scanner-panel">
                <div class="whale-table-header scanner-header">
                    <div class="scanner-header-left">
                        <h3>ğŸ” Liquid Market Whale Scanner</h3>
                        <span class="whale-section-sub">Multi-source discovery: Leaderboard seeding Â· Global trade feed Â· Per-market scanning Â· Smart dedup</span>
                    </div>
                    <div class="scanner-header-right">
                        <span class="scanner-status-badge" id="scanner-status-badge">â— IDLE</span>
                        <button class="scanner-btn scanner-btn-primary" id="scanner-toggle-btn" onclick="toggleWhaleScanner()">â–¶ Start Scanner</button>
                        <button class="scanner-btn scanner-btn-secondary" onclick="runSingleScan()" title="Run a one-time scan">âš¡ Quick Scan</button>
                        <button class="scanner-btn scanner-btn-ghost" onclick="toggleScannerConfig()" title="Configure scanner parameters">âš™ï¸</button>
                    </div>
                </div>

                <!-- Continuous Scan Live Status Bar -->
                <div class="scanner-live-status" id="scanner-live-status" style="display:none;"></div>

                <!-- API Pool Status Panel -->
                <div class="scanner-pool-panel" id="scanner-pool-panel" style="display:none;">
                    <div class="scanner-pool-header">
                        <span class="scanner-pool-title">ğŸ”‘ API Pool</span>
                        <span class="scanner-pool-summary" id="scanner-pool-summary"></span>
                    </div>
                    <div class="scanner-pool-endpoints" id="scanner-pool-endpoints"></div>
                </div>

                <!-- Scanner Config Panel (collapsible) -->
                <div class="scanner-config-panel" id="scanner-config-panel" style="display:none;">
                    <div class="scanner-config-grid">
                        <div class="scanner-config-item">
                            <label>Min Market Volume</label>
                            <input type="number" id="scanner-cfg-volume" value="50000" min="1000" step="5000">
                        </div>
                        <div class="scanner-config-item">
                            <label>Min Liquidity</label>
                            <input type="number" id="scanner-cfg-liquidity" value="10000" min="1000" step="1000">
                        </div>
                        <div class="scanner-config-item">
                            <label>Min Win Rate</label>
                            <input type="number" id="scanner-cfg-winrate" value="0.45" min="0" max="1" step="0.05">
                        </div>
                        <div class="scanner-config-item">
                            <label>Min PnL ($)</label>
                            <input type="number" id="scanner-cfg-pnl" value="5000" min="0" step="1000">
                        </div>
                        <div class="scanner-config-item">
                            <label>Min Positions</label>
                            <input type="number" id="scanner-cfg-positions" value="5" min="1" step="1">
                        </div>
                        <div class="scanner-config-item">
                            <label>Scan Interval (min)</label>
                            <input type="number" id="scanner-cfg-interval" value="15" min="5" step="5">
                        </div>
                    </div>
                    <button class="scanner-btn scanner-btn-primary" onclick="saveScannerConfig()" style="margin-top:8px;">ğŸ’¾ Save Config</button>
                </div>

                <!-- 7-Phase Pipeline Visualization -->
                <div class="scanner-pipeline" id="scanner-pipeline">
                    <div class="scanner-phase" id="scanner-phase-0">
                        <div class="scanner-phase-icon">ï¿½</div>
                        <div class="scanner-phase-label">Leaderboard</div>
                        <div class="scanner-phase-val" id="scanner-phase-0-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-1">
                        <div class="scanner-phase-icon">ğŸ¦</div>
                        <div class="scanner-phase-label">Markets</div>
                        <div class="scanner-phase-val" id="scanner-phase-1-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-2">
                        <div class="scanner-phase-icon">ğŸ“¡</div>
                        <div class="scanner-phase-label">Global Trades</div>
                        <div class="scanner-phase-val" id="scanner-phase-2-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-2b">
                        <div class="scanner-phase-icon">ğŸ“Š</div>
                        <div class="scanner-phase-label">Market Trades</div>
                        <div class="scanner-phase-val" id="scanner-phase-2b-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-3">
                        <div class="scanner-phase-icon">ï¿½</div>
                        <div class="scanner-phase-label">Ranking</div>
                        <div class="scanner-phase-val" id="scanner-phase-3-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-4">
                        <div class="scanner-phase-icon">ğŸ”¬</div>
                        <div class="scanner-phase-label">Analysis</div>
                        <div class="scanner-phase-val" id="scanner-phase-4-val">â€”</div>
                    </div>
                    <div class="scanner-phase-arrow">â†’</div>
                    <div class="scanner-phase" id="scanner-phase-5">
                        <div class="scanner-phase-icon">ğŸ’¾</div>
                        <div class="scanner-phase-label">Score &amp; Save</div>
                        <div class="scanner-phase-val" id="scanner-phase-5-val">â€”</div>
                    </div>
                </div>

                <!-- Scanner Stats Row (8 cards) -->
                <div class="scanner-stats-row" id="scanner-stats-row">
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ¦</div>
                        <div class="scanner-stat-val" id="scanner-stat-markets">0</div>
                        <div class="scanner-stat-label">Liquid Markets</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ”„</div>
                        <div class="scanner-stat-val" id="scanner-stat-cycle-markets">0</div>
                        <div class="scanner-stat-label">Scanned / Cycle</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ“¡</div>
                        <div class="scanner-stat-val" id="scanner-stat-trades">0</div>
                        <div class="scanner-stat-label">Trades Analyzed</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ”</div>
                        <div class="scanner-stat-val" id="scanner-stat-addresses">0</div>
                        <div class="scanner-stat-label">Addresses Found</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ‘›</div>
                        <div class="scanner-stat-val" id="scanner-stat-wallets">0</div>
                        <div class="scanner-stat-label">Wallets Analyzed</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ‹</div>
                        <div class="scanner-stat-val" id="scanner-stat-candidates">0</div>
                        <div class="scanner-stat-label">Candidates</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">â­</div>
                        <div class="scanner-stat-val" id="scanner-stat-promoted">0</div>
                        <div class="scanner-stat-label">Promoted</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ†</div>
                        <div class="scanner-stat-val" id="scanner-stat-leaderboard">0</div>
                        <div class="scanner-stat-label">Leaderboard</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">ğŸ“Š</div>
                        <div class="scanner-stat-val" id="scanner-stat-mkt-trades">0</div>
                        <div class="scanner-stat-label">Market Trades</div>
                    </div>
                    <div class="scanner-stat-card">
                        <div class="scanner-stat-icon">â±ï¸</div>
                        <div class="scanner-stat-val" id="scanner-stat-duration">â€”</div>
                        <div class="scanner-stat-label">Scan Time</div>
                    </div>
                </div>

                <!-- Scanned Markets Grid -->
                <div class="scanner-markets-wrap" id="scanner-markets-wrap" style="display:none;">
                    <h4 class="scanner-sub-title">ğŸ“ˆ Markets Scanned This Cycle</h4>
                    <div class="scanner-markets-grid" id="scanner-markets-grid"></div>
                </div>

                <!-- Grade Distribution Bar -->
                <div class="scanner-grade-bar-wrap" id="scanner-grade-bar-wrap">
                    <h4 class="scanner-sub-title">Grade Distribution</h4>
                    <div class="scanner-grade-bar" id="scanner-grade-bar"></div>
                    <div class="scanner-grade-legend" id="scanner-grade-legend"></div>
                </div>

                <!-- Candidate Table -->
                <div class="scanner-candidates-wrap">
                    <div class="scanner-candidates-header">
                        <h4 class="scanner-sub-title">ğŸ† Top Whale Candidates</h4>
                        <span class="scanner-candidate-count" id="scanner-candidate-count">0 candidates</span>
                    </div>
                    <div class="scanner-candidates-table" id="scanner-candidates-table">
                        <div class="empty-state">Run a scan to discover whale candidates</div>
                    </div>
                </div>

                <!-- Promoted Whales -->
                <div class="scanner-promoted-wrap" id="scanner-promoted-wrap" style="display:none;">
                    <h4 class="scanner-sub-title">âœ… Promoted to Tracked</h4>
                    <div class="scanner-promoted-list" id="scanner-promoted-list"></div>
                </div>
            </div>

            <!-- â”€â”€â”€ 6 KPI Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-kpi-row">
                <div class="whale-kpi accent-blue">
                    <div class="whale-kpi-icon">ğŸ”­</div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Tracked Wallets</div>
                        <div class="whale-kpi-value" id="whale-total-wallets">0</div>
                        <div class="whale-kpi-sub" id="whale-total-positions">0 positions</div>
                    </div>
                </div>
                <div class="whale-kpi accent-green">
                    <div class="whale-kpi-icon">ğŸ¯</div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Conviction Signals</div>
                        <div class="whale-kpi-value" id="whale-total-signals">0</div>
                        <div class="whale-kpi-sub" id="whale-signal-breakdown">Strong: 0 Â· Mod: 0</div>
                    </div>
                </div>
                <div class="whale-kpi accent-purple">
                    <div class="whale-kpi-icon">ğŸ§ </div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Smart Money Index</div>
                        <div class="whale-kpi-value" id="whale-smi">50</div>
                        <div class="whale-kpi-sub" id="whale-smi-label">Neutral</div>
                    </div>
                </div>
                <div class="whale-kpi accent-teal">
                    <div class="whale-kpi-icon">ğŸ’°</div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Net Whale Flow</div>
                        <div class="whale-kpi-value" id="whale-net-flow">$0</div>
                        <div class="whale-kpi-sub" id="whale-flow-detail">In: $0 Â· Out: $0</div>
                    </div>
                </div>
                <div class="whale-kpi accent-orange">
                    <div class="whale-kpi-icon">ğŸ“Š</div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Avg Win Rate</div>
                        <div class="whale-kpi-value" id="whale-avg-winrate">0%</div>
                        <div class="whale-kpi-sub" id="whale-total-pnl">Total P&L: $0</div>
                    </div>
                </div>
                <div class="whale-kpi accent-pink">
                    <div class="whale-kpi-icon">ğŸ†</div>
                    <div class="whale-kpi-body">
                        <div class="whale-kpi-label">Top Conviction</div>
                        <div class="whale-kpi-value" id="whale-top-conv-score">0</div>
                        <div class="whale-kpi-sub whale-kpi-sub-trunc" id="whale-top-conv-market">â€”</div>
                    </div>
                </div>
            </div>

            <!-- â”€â”€â”€ Smart Money Index Gauge + Flow Breakdown â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-gauge-row">
                <div class="whale-gauge-card">
                    <h3>ğŸ§  Smart Money Index</h3>
                    <div class="whale-gauge-wrap">
                        <div class="whale-gauge-bar">
                            <div class="whale-gauge-fill" id="whale-smi-fill" style="width:50%;"></div>
                            <div class="whale-gauge-marker" id="whale-smi-marker" style="left:50%;"></div>
                        </div>
                        <div class="whale-gauge-labels">
                            <span class="whale-gauge-bear">ğŸ» Bearish</span>
                            <span class="whale-gauge-neutral">Neutral</span>
                            <span class="whale-gauge-bull">Bullish ğŸ‚</span>
                        </div>
                    </div>
                    <p class="whale-gauge-desc" id="whale-smi-desc">Smart Money Index aggregates whale conviction across all active signals, weighted by position size.</p>
                </div>
                <div class="whale-gauge-card">
                    <h3>ğŸ“¡ Flow Breakdown</h3>
                    <div class="whale-flow-bars">
                        <div class="whale-flow-item">
                            <span class="whale-flow-label">ğŸŸ¢ Entries</span>
                            <div class="whale-flow-bar-wrap"><div class="whale-flow-bar whale-flow-green" id="whale-flow-entries" style="width:0%;"></div></div>
                            <span class="whale-flow-count" id="whale-flow-entries-n">0</span>
                        </div>
                        <div class="whale-flow-item">
                            <span class="whale-flow-label">ğŸ“ˆ Size â†‘</span>
                            <div class="whale-flow-bar-wrap"><div class="whale-flow-bar whale-flow-teal" id="whale-flow-incr" style="width:0%;"></div></div>
                            <span class="whale-flow-count" id="whale-flow-incr-n">0</span>
                        </div>
                        <div class="whale-flow-item">
                            <span class="whale-flow-label">ğŸ“‰ Size â†“</span>
                            <div class="whale-flow-bar-wrap"><div class="whale-flow-bar whale-flow-orange" id="whale-flow-decr" style="width:0%;"></div></div>
                            <span class="whale-flow-count" id="whale-flow-decr-n">0</span>
                        </div>
                        <div class="whale-flow-item">
                            <span class="whale-flow-label">ğŸ”´ Exits</span>
                            <div class="whale-flow-bar-wrap"><div class="whale-flow-bar whale-flow-red" id="whale-flow-exits" style="width:0%;"></div></div>
                            <span class="whale-flow-count" id="whale-flow-exits-n">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- â”€â”€â”€ Momentum & Velocity Panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-momentum-panel">
                <div class="whale-momentum-card">
                    <h3>ğŸ“ˆ Whale Momentum <span class="whale-section-sub">(Net Flow by Window)</span></h3>
                    <div class="whale-momentum-bars" id="whale-momentum-bars">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="whale-momentum-card">
                    <h3>âš¡ Position Velocity <span class="whale-section-sub">(Actions/Hour)</span></h3>
                    <div class="whale-velocity-row" id="whale-velocity-row">
                        <div class="whale-velocity-item">
                            <span class="whale-velocity-label">1h</span>
                            <span class="whale-velocity-value" id="whale-vel-1h">0</span>
                        </div>
                        <div class="whale-velocity-item">
                            <span class="whale-velocity-label">6h</span>
                            <span class="whale-velocity-value" id="whale-vel-6h">0</span>
                        </div>
                        <div class="whale-velocity-item">
                            <span class="whale-velocity-label">24h</span>
                            <span class="whale-velocity-value" id="whale-vel-24h">0</span>
                        </div>
                    </div>
                    <div class="whale-herd-index">
                        <span class="whale-herd-label">ğŸ‘ Herd Behavior Index</span>
                        <div class="whale-herd-bar-wrap">
                            <div class="whale-herd-bar" id="whale-herd-bar" style="width:0%;"></div>
                        </div>
                        <span class="whale-herd-value" id="whale-herd-value">0%</span>
                    </div>
                </div>
            </div>

            <!-- â”€â”€â”€ Charts Row (FIXED HEIGHT) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-charts-row">
                <div class="whale-chart-card">
                    <h3>ğŸ“Š Signal Direction</h3>
                    <div class="whale-chart-container" style="height:200px;">
                        <canvas id="whale-direction-chart"></canvas>
                    </div>
                </div>
                <div class="whale-chart-card">
                    <h3>ğŸ”ï¸ Top Markets by Whale Capital</h3>
                    <div class="whale-chart-container" style="height:200px;">
                        <canvas id="whale-markets-chart"></canvas>
                    </div>
                </div>
                <div class="whale-chart-card">
                    <h3>ğŸ·ï¸ Category Breakdown</h3>
                    <div class="whale-chart-container" style="height:200px;">
                        <canvas id="whale-category-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- â”€â”€â”€ Activity Timeline Heatmap â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-timeline-section">
                <h3>â±ï¸ Activity Timeline <span class="whale-section-sub">(Last 24 hours)</span></h3>
                <div class="whale-timeline-grid" id="whale-timeline-grid">
                    <!-- Populated by JS -->
                </div>
                <div class="whale-timeline-legend">
                    <span class="whale-tl-legend-item"><span class="whale-tl-cell whale-tl-0"></span> None</span>
                    <span class="whale-tl-legend-item"><span class="whale-tl-cell whale-tl-1"></span> Low</span>
                    <span class="whale-tl-legend-item"><span class="whale-tl-cell whale-tl-2"></span> Medium</span>
                    <span class="whale-tl-legend-item"><span class="whale-tl-cell whale-tl-3"></span> High</span>
                    <span class="whale-tl-legend-item"><span class="whale-tl-cell whale-tl-4"></span> Surge</span>
                </div>
            </div>

            <!-- â”€â”€â”€ Accumulation / Distribution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ”„ Accumulation / Distribution</h3>
                    <span class="whale-section-sub">Net buy vs sell pressure per market</span>
                </div>
                <div class="whale-accum-list" id="whale-accum-list">
                    <div class="empty-state">No accumulation data yet</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Whale Overlap Matrix â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ”— Whale Overlap Matrix</h3>
                    <span class="whale-section-sub">Shared market positions between whales</span>
                </div>
                <div class="whale-overlap-grid" id="whale-overlap-grid">
                    <div class="empty-state">No whale overlap data yet</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Whale Tier Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-tier-summary-row" id="whale-tier-summary">
                <!-- Populated by JS -->
            </div>

            <!-- â”€â”€â”€ High Consensus Alerts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-consensus-section" id="whale-consensus-wrap">
                <h3>ğŸ”¥ High Consensus Alerts <span class="whale-consensus-badge" id="whale-consensus-count">0</span></h3>
                <p class="whale-consensus-desc">Markets where 3+ whales agree on the same outcome â€” strongest smart money signals.</p>
                <div class="whale-consensus-grid" id="whale-consensus-grid">
                    <div class="empty-state" style="grid-column:1/-1;">No high consensus signals yet</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Conviction Signals Table (Pro) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ¯ Conviction Signals</h3>
                    <div class="whale-table-filters">
                        <select id="whale-signal-filter" onchange="filterWhaleSignals()" class="whale-filter-select">
                            <option value="all">All Signals</option>
                            <option value="STRONG">Strong Only</option>
                            <option value="MODERATE">Moderate+</option>
                            <option value="BULLISH">Bullish</option>
                            <option value="BEARISH">Bearish</option>
                        </select>
                        <select id="whale-category-filter" onchange="filterWhaleSignals()" class="whale-filter-select">
                            <option value="all">All Categories</option>
                            <option value="NBA">ğŸ€ NBA</option>
                            <option value="NFL">ğŸˆ NFL</option>
                            <option value="Soccer">âš½ Soccer</option>
                            <option value="Politics">ğŸ›ï¸ Politics</option>
                            <option value="Olympics">ğŸ… Olympics</option>
                            <option value="MLB">âš¾ MLB</option>
                            <option value="Crypto">â‚¿ Crypto</option>
                            <option value="Other">ğŸ“¦ Other</option>
                        </select>
                        <input type="text" id="whale-signal-search" placeholder="Search marketsâ€¦" oninput="filterWhaleSignals()" class="whale-filter-input">
                    </div>
                </div>
                <div class="whale-table-scroll">
                    <table id="conviction-table" class="whale-pro-table">
                        <thead><tr>
                            <th>Market</th><th>Category</th><th>Outcome</th><th>ğŸ‹</th><th>Capital</th>
                            <th>Entry</th><th>Current</th><th>Edge</th><th>Conviction</th>
                            <th>Trend</th><th>Strength</th><th>Fresh</th><th>Age</th><th>Dir</th>
                        </tr></thead>
                        <tbody id="conviction-body">
                            <tr><td colspan="14" class="empty-state">No conviction signals yet â€” run a wallet scan to populate</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- â”€â”€â”€ Live Activity Feed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ“¡ Live Activity Feed</h3>
                    <div class="whale-table-filters">
                        <select id="whale-activity-filter" onchange="filterWhaleActivity()" class="whale-filter-select">
                            <option value="all">All Activity</option>
                            <option value="NEW_ENTRY">ğŸŸ¢ Entries</option>
                            <option value="EXIT">ğŸ”´ Exits</option>
                            <option value="SIZE_INCREASE">ğŸ“ˆ Size â†‘</option>
                            <option value="SIZE_DECREASE">ğŸ“‰ Size â†“</option>
                        </select>
                    </div>
                </div>
                <div class="whale-feed" id="whale-activity-feed">
                    <div class="empty-state">No whale activity detected yet</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Whale Leaderboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ† Whale Leaderboard</h3>
                    <div class="whale-table-filters">
                        <select id="whale-lb-sort" onchange="sortWhaleLeaderboard()" class="whale-filter-select">
                            <option value="score">By Score</option>
                            <option value="pnl">By P&L</option>
                            <option value="winrate">By Win Rate</option>
                            <option value="follow">By Follow P&L</option>
                            <option value="activity">By Activity</option>
                            <option value="positions">By Positions</option>
                        </select>
                    </div>
                </div>
                <div class="whale-leaderboard" id="whale-leaderboard">
                    <div class="empty-state">No wallets tracked yet</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Alert History â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="whale-section-card">
                <div class="whale-table-header">
                    <h3>ğŸ”” Alert History <span class="whale-consensus-badge" id="whale-alert-history-count">0</span></h3>
                    <span class="whale-section-sub">Persistent log of all risk alerts detected by the whale scanner</span>
                </div>
                <div class="whale-alert-history-list" id="whale-alert-history-list">
                    <div class="empty-state">No alerts recorded yet</div>
                </div>
            </div>

        </section>

    </div>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB: DECISION INTELLIGENCE                              -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-decisions" data-tab="decisions">

        <!-- â”€â”€â”€ Decision Intelligence Toolbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel di-panel-main">
            <div class="di-toolbar">
                <div class="di-toolbar-left">
                    <h2 class="di-title">ğŸ§  Decision Intelligence Center</h2>
                    <span class="di-pulse" id="di-pulse">â— LIVE</span>
                </div>
                <div class="di-toolbar-right">
                    <span class="di-stat" id="di-last-cycle">Last cycle: â€”</span>
                    <span class="di-divider">|</span>
                    <span class="di-stat" id="di-total-count">0 decisions</span>
                    <button class="di-btn-export" onclick="exportDecisionCSV()" title="Export CSV">ğŸ“¥ Export</button>
                </div>
            </div>

            <!-- â”€â”€â”€ KPI Row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-kpi-row" id="di-kpi-row">
                <div class="di-kpi-card">
                    <div class="di-kpi-icon">ğŸ“Š</div>
                    <div class="di-kpi-val" id="di-kpi-total">0</div>
                    <div class="di-kpi-label">Total Decisions</div>
                </div>
                <div class="di-kpi-card di-kpi-green">
                    <div class="di-kpi-icon">âœ…</div>
                    <div class="di-kpi-val" id="di-kpi-trade-rate">0%</div>
                    <div class="di-kpi-label">Trade Rate</div>
                </div>
                <div class="di-kpi-card di-kpi-blue">
                    <div class="di-kpi-icon">ğŸ¯</div>
                    <div class="di-kpi-val" id="di-kpi-avg-score">â€”</div>
                    <div class="di-kpi-label">Avg DI Score</div>
                </div>
                <div class="di-kpi-card di-kpi-purple">
                    <div class="di-kpi-icon">ğŸ“ˆ</div>
                    <div class="di-kpi-val" id="di-kpi-avg-edge">â€”</div>
                    <div class="di-kpi-label">Avg Edge</div>
                </div>
                <div class="di-kpi-card di-kpi-teal">
                    <div class="di-kpi-icon">ğŸ“š</div>
                    <div class="di-kpi-val" id="di-kpi-avg-eq">â€”</div>
                    <div class="di-kpi-label">Avg Evidence Quality</div>
                </div>
                <div class="di-kpi-card di-kpi-orange">
                    <div class="di-kpi-icon">âš¡</div>
                    <div class="di-kpi-val" id="di-kpi-pipeline">â€”</div>
                    <div class="di-kpi-label">Pipeline Completion</div>
                </div>
                <div class="di-kpi-card di-kpi-pink">
                    <div class="di-kpi-icon">ğŸ·ï¸</div>
                    <div class="di-kpi-val" id="di-kpi-top-cat">â€”</div>
                    <div class="di-kpi-label">Top Category</div>
                </div>
                <div class="di-kpi-card">
                    <div class="di-kpi-icon">ğŸ†</div>
                    <div class="di-kpi-val" id="di-kpi-avg-grade">â€”</div>
                    <div class="di-kpi-label">Avg Grade</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Charts Row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-charts-row">
                <div class="di-chart-card">
                    <h3>ğŸ“Š Decision Distribution</h3>
                    <canvas id="di-chart-decisions"></canvas>
                </div>
                <div class="di-chart-card">
                    <h3>ğŸ† Grade Distribution</h3>
                    <canvas id="di-chart-grades"></canvas>
                </div>
                <div class="di-chart-card">
                    <h3>ğŸ“ˆ Edge Distribution</h3>
                    <canvas id="di-chart-edge"></canvas>
                </div>
                <div class="di-chart-card">
                    <h3>ğŸ·ï¸ Category Breakdown</h3>
                    <canvas id="di-chart-categories"></canvas>
                </div>
            </div>

            <!-- â”€â”€â”€ Decision Timeline Heatmap â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-timeline-section">
                <h3>ğŸ• Decision Activity Timeline</h3>
                <div class="di-timeline-strip" id="di-timeline-strip"></div>
            </div>

            <!-- â”€â”€â”€ Pipeline Flow Funnel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-funnel-section">
                <h3>âš¡ Pipeline Funnel</h3>
                <div class="di-funnel" id="di-funnel"></div>
            </div>

            <!-- â”€â”€â”€ Auto Insights â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-insights-section">
                <div class="di-section-header">
                    <h3>ğŸ’¡ Auto-Generated Insights</h3>
                    <span class="di-badge" id="di-insights-count">0</span>
                </div>
                <div class="di-insights-grid" id="di-insights">
                    <div class="empty-state" style="padding:20px 0;">No insights yet â€” run more cycles to generate patterns.</div>
                </div>
            </div>

            <!-- â”€â”€â”€ DI Score Trend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-score-trend-section">
                <h3>ğŸ“ˆ DI Score &amp; Trade Rate Trend</h3>
                <div class="di-chart-wrap">
                    <canvas id="di-score-trend" height="220"></canvas>
                </div>
            </div>

            <!-- â”€â”€â”€ Two-Column: Calibration + Category Rank â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-two-col-row">
                <div class="di-calibration-section">
                    <h3>ğŸ¯ Confidence Calibration</h3>
                    <div id="di-calibration">
                        <div class="empty-state" style="padding:20px 0;">No calibration data yet.</div>
                    </div>
                </div>
                <div class="di-category-rank-section">
                    <h3>ğŸ† Category Performance Ranking</h3>
                    <div id="di-category-rank">
                        <div class="empty-state" style="padding:20px 0;">No category data yet.</div>
                    </div>
                </div>
            </div>

            <!-- â”€â”€â”€ Trade Outcomes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-outcomes-section">
                <div class="di-section-header">
                    <h3>ğŸ¯ Trade Outcomes</h3>
                    <span class="di-badge" id="di-outcomes-count">0</span>
                </div>
                <div class="di-outcomes-grid" id="di-outcomes-list">
                    <div class="empty-state" style="padding:20px 0;">No outcome data yet.</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Research ROI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-research-roi-section">
                <h3>ğŸ“š Research Quality ROI</h3>
                <div id="di-research-roi">
                    <div class="empty-state" style="padding:20px 0;">No research ROI data yet.</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Missed Opportunities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-missed-section">
                <div class="di-section-header">
                    <h3>ğŸ” Missed Opportunities</h3>
                    <span class="di-badge di-badge-warn" id="di-missed-count">0</span>
                </div>
                <div class="di-missed-grid" id="di-missed-opps">
                    <div class="empty-state" style="padding:20px 0;">No missed opportunities detected.</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Enhanced Filter Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="di-filter-bar">
                <input type="text" class="di-search" id="di-search" placeholder="ğŸ” Search markets, questionsâ€¦" oninput="filterDecisionCards()">
                <select id="decision-cycle-filter" class="di-select" onchange="updateDecisionLog()">
                    <option value="">All Cycles</option>
                </select>
                <select id="decision-filter" class="di-select" onchange="filterDecisionCards()">
                    <option value="">All Decisions</option>
                    <option value="TRADE">âœ… Trade</option>
                    <option value="NO TRADE">âŒ No Trade</option>
                    <option value="SKIP">â­ï¸ Skip</option>
                </select>
                <select id="di-grade-filter" class="di-select" onchange="filterDecisionCards()">
                    <option value="">All Grades</option>
                    <option value="A">A+/A</option>
                    <option value="B">B+/B</option>
                    <option value="C">C+/C</option>
                    <option value="D">D</option>
                    <option value="F">F</option>
                </select>
                <select id="di-category-filter" class="di-select" onchange="filterDecisionCards()">
                    <option value="">All Categories</option>
                </select>
                <button class="di-btn" onclick="toggleDecisionExpand()" id="btn-expand-all">Expand All</button>
                <span class="di-filter-count" id="di-filter-count"></span>
            </div>

            <!-- â”€â”€â”€ Decision Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div id="decision-log-container">
                <div class="empty-state" style="padding:40px 0;">No decision data yet â€” run an engine cycle to see how the bot makes decisions.</div>
            </div>
        </section>

    </div>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB: STRATEGIES & WALLETS                               -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-strategies" data-tab="strategies">

        <section class="panel sw-panel-main">
            <!-- â”€â”€â”€ Header Toolbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="sw-toolbar">
                <div class="sw-toolbar-left">
                    <h2 class="sw-title">ğŸ¯ Strategies & Wallets</h2>
                    <span class="sw-pulse" id="sw-pulse">â— LIVE</span>
                </div>
                <div class="sw-toolbar-right">
                    <button class="sw-btn sw-btn-primary" onclick="showCreateWalletModal()">ï¼‹ New Wallet</button>
                    <button class="sw-btn sw-btn-secondary" onclick="showCreateStrategyModal()">ï¼‹ New Strategy</button>
                </div>
            </div>

            <!-- â”€â”€â”€ Summary KPIs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="sw-kpi-row" id="sw-kpi-row">
                <div class="sw-kpi-card">
                    <div class="sw-kpi-icon">ğŸ’°</div>
                    <div class="sw-kpi-val" id="sw-kpi-balance">$0</div>
                    <div class="sw-kpi-label">Total Balance</div>
                </div>
                <div class="sw-kpi-card sw-kpi-green">
                    <div class="sw-kpi-icon">ğŸ“ˆ</div>
                    <div class="sw-kpi-val" id="sw-kpi-pnl">$0</div>
                    <div class="sw-kpi-label">Total P&L</div>
                </div>
                <div class="sw-kpi-card sw-kpi-blue">
                    <div class="sw-kpi-icon">ğŸ“„</div>
                    <div class="sw-kpi-val" id="sw-kpi-paper">0</div>
                    <div class="sw-kpi-label">Paper Wallets</div>
                </div>
                <div class="sw-kpi-card sw-kpi-purple">
                    <div class="sw-kpi-icon">ğŸ”‘</div>
                    <div class="sw-kpi-val" id="sw-kpi-live">0</div>
                    <div class="sw-kpi-label">Live Wallets</div>
                </div>
                <div class="sw-kpi-card sw-kpi-orange">
                    <div class="sw-kpi-icon">ğŸ¤–</div>
                    <div class="sw-kpi-val" id="sw-kpi-strategies">0</div>
                    <div class="sw-kpi-label">Active Strategies</div>
                </div>
                <div class="sw-kpi-card sw-kpi-teal">
                    <div class="sw-kpi-icon">ğŸ“Š</div>
                    <div class="sw-kpi-val" id="sw-kpi-trades">0</div>
                    <div class="sw-kpi-label">Total Trades</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Wallets Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="sw-section">
                <div class="sw-section-header">
                    <h3>ğŸ’° Wallets</h3>
                    <div class="sw-section-controls">
                        <select id="sw-wallet-filter" class="sw-select" onchange="filterWalletCards()">
                            <option value="">All Wallets</option>
                            <option value="paper">ğŸ“„ Paper</option>
                            <option value="live">ğŸ”‘ Live</option>
                        </select>
                    </div>
                </div>
                <div class="sw-wallet-grid" id="sw-wallet-grid">
                    <div class="empty-state" style="padding:30px 0;">Loading walletsâ€¦</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Strategies Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="sw-section">
                <div class="sw-section-header">
                    <h3>ğŸ¤– Strategies</h3>
                </div>
                <div class="sw-strategy-grid" id="sw-strategy-grid">
                    <div class="empty-state" style="padding:30px 0;">Loading strategiesâ€¦</div>
                </div>
            </div>

            <!-- â”€â”€â”€ Wallet Performance Detail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
            <div class="sw-section" id="sw-perf-section" style="display:none;">
                <div class="sw-section-header">
                    <h3 id="sw-perf-title">ğŸ“Š Wallet Performance</h3>
                    <button class="sw-btn sw-btn-sm" onclick="closePerfPanel()">âœ• Close</button>
                </div>
                <div class="sw-perf-kpis" id="sw-perf-kpis"></div>
                <div class="sw-perf-chart-wrap">
                    <canvas id="sw-perf-chart"></canvas>
                </div>
                <div class="sw-perf-trades" id="sw-perf-trades"></div>
            </div>

        </section>

        <!-- â”€â”€â”€ Create Wallet Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="modal-overlay" id="modal-create-wallet" style="display:none;">
            <div class="modal-content sw-modal">
                <div class="modal-header">
                    <h3>ğŸ’° Create New Wallet</h3>
                    <button class="modal-close" onclick="closeSWModal('modal-create-wallet')">âœ•</button>
                </div>
                <div class="modal-body">
                    <div class="sw-form-group">
                        <label>Wallet Name</label>
                        <input type="text" id="sw-new-wallet-name" class="sw-input" placeholder="e.g. Conservative Paper, Main Liveâ€¦">
                    </div>
                    <div class="sw-form-group">
                        <label>Type</label>
                        <div class="sw-type-toggle">
                            <button class="sw-type-btn active" data-type="paper" onclick="selectWalletType('paper')">ğŸ“„ Paper Trading</button>
                            <button class="sw-type-btn" data-type="live" onclick="selectWalletType('live')">ğŸ”‘ Live Wallet</button>
                        </div>
                    </div>
                    <div class="sw-form-group" id="sw-address-group" style="display:none;">
                        <label>Wallet Address</label>
                        <input type="text" id="sw-new-wallet-address" class="sw-input" placeholder="0xâ€¦">
                    </div>
                    <div class="sw-form-group" id="sw-balance-group">
                        <label>Starting Balance (USD)</label>
                        <input type="number" id="sw-new-wallet-balance" class="sw-input" value="10000" min="100" step="100">
                    </div>
                    <div class="sw-form-group">
                        <label>Color</label>
                        <div class="sw-color-picker">
                            <button class="sw-color-swatch active" data-color="#4c8dff" style="background:#4c8dff;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#00e68a" style="background:#00e68a;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#a855f7" style="background:#a855f7;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#f59e0b" style="background:#f59e0b;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#ec4899" style="background:#ec4899;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#06b6d4" style="background:#06b6d4;" onclick="selectWalletColor(this)"></button>
                            <button class="sw-color-swatch" data-color="#ef4444" style="background:#ef4444;" onclick="selectWalletColor(this)"></button>
                        </div>
                    </div>
                    <div class="sw-form-group">
                        <label>Notes (optional)</label>
                        <input type="text" id="sw-new-wallet-notes" class="sw-input" placeholder="Purpose or descriptionâ€¦">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="sw-btn sw-btn-primary" onclick="createWallet()">Create Wallet</button>
                </div>
            </div>
        </div>

        <!-- â”€â”€â”€ Create Strategy Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="modal-overlay" id="modal-create-strategy" style="display:none;">
            <div class="modal-content sw-modal">
                <div class="modal-header">
                    <h3>ğŸ¤– Create New Strategy</h3>
                    <button class="modal-close" onclick="closeSWModal('modal-create-strategy')">âœ•</button>
                </div>
                <div class="modal-body">
                    <div class="sw-form-group">
                        <label>Strategy Name</label>
                        <input type="text" id="sw-new-strat-name" class="sw-input" placeholder="e.g. Conservative AI, Whale Followâ€¦">
                    </div>
                    <div class="sw-form-group">
                        <label>Strategy Type</label>
                        <select id="sw-new-strat-type" class="sw-select-full">
                            <option value="ai_trading">ğŸ¤– AI Trading â€” Automated AI-powered ensemble forecasting</option>
                            <option value="manual">ğŸ¯ Manual â€” User-directed manual trades</option>
                            <option value="momentum">ğŸš€ Momentum â€” Follow price trends and whale activity</option>
                            <option value="mean_reversion">ğŸ“‰ Mean Reversion â€” Bet on prices returning to fair value</option>
                            <option value="whale_follow">ğŸ‹ Whale Follow â€” Mirror smart-money whale positions</option>
                            <option value="arbitrage">âš–ï¸ Arbitrage â€” Exploit price discrepancies across markets</option>
                            <option value="custom">ğŸ”§ Custom â€” User-defined custom strategy</option>
                        </select>
                    </div>
                    <div class="sw-form-group">
                        <label>Risk Profile</label>
                        <div class="sw-risk-toggle">
                            <button class="sw-risk-btn" data-risk="conservative" onclick="selectRiskProfile('conservative')">ğŸ›¡ï¸ Conservative</button>
                            <button class="sw-risk-btn active" data-risk="moderate" onclick="selectRiskProfile('moderate')">âš–ï¸ Moderate</button>
                            <button class="sw-risk-btn" data-risk="aggressive" onclick="selectRiskProfile('aggressive')">ğŸ”¥ Aggressive</button>
                        </div>
                    </div>
                    <div class="sw-form-group">
                        <label>Description (optional)</label>
                        <textarea id="sw-new-strat-desc" class="sw-textarea" rows="2" placeholder="What this strategy doesâ€¦"></textarea>
                    </div>
                    <div class="sw-form-group">
                        <label>Assign to Wallet</label>
                        <select id="sw-new-strat-wallet" class="sw-select-full">
                            <option value="">No wallet (assign later)</option>
                        </select>
                    </div>
                    <div class="sw-form-group" id="sw-alloc-group" style="display:none;">
                        <label>Allocated Balance (USD)</label>
                        <input type="number" id="sw-new-strat-alloc" class="sw-input" value="5000" min="0" step="100">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="sw-btn sw-btn-primary" onclick="createStrategy()">Create Strategy</button>
                </div>
            </div>
        </div>

        <!-- â”€â”€â”€ Assign Strategy Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="modal-overlay" id="modal-assign-strategy" style="display:none;">
            <div class="modal-content sw-modal">
                <div class="modal-header">
                    <h3>ğŸ”— Assign Strategy to Wallet</h3>
                    <button class="modal-close" onclick="closeSWModal('modal-assign-strategy')">âœ•</button>
                </div>
                <div class="modal-body">
                    <div class="sw-form-group">
                        <label>Strategy</label>
                        <select id="sw-assign-strategy" class="sw-select-full"></select>
                    </div>
                    <div class="sw-form-group">
                        <label>Wallet</label>
                        <select id="sw-assign-wallet" class="sw-select-full"></select>
                    </div>
                    <div class="sw-form-group">
                        <label>Allocated Balance (USD)</label>
                        <input type="number" id="sw-assign-alloc" class="sw-input" value="5000" min="0" step="100">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="sw-btn sw-btn-primary" onclick="assignStrategyToWallet()">Assign</button>
                </div>
            </div>
        </div>

    </div>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB: JOURNAL & WATCHLIST                                -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-journal" data-tab="journal">

        <!-- â”€â”€â”€ Portfolio VaR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card" style="margin-bottom:16px;">
            <h2>ğŸ“‰ Portfolio Value-at-Risk</h2>
            <div class="kpi-grid" style="grid-template-columns: repeat(4,1fr);">
                <div class="kpi-card"><div class="kpi-label">VaR 95%</div><div class="kpi-value" id="var-95">$0.00</div></div>
                <div class="kpi-card"><div class="kpi-label">VaR 99%</div><div class="kpi-value" id="var-99">$0.00</div></div>
                <div class="kpi-card"><div class="kpi-label">Expected Loss</div><div class="kpi-value" id="var-expected-loss">$0.00</div></div>
                <div class="kpi-card"><div class="kpi-label">Positions</div><div class="kpi-value" id="var-positions">0</div></div>
            </div>
        </section>

        <!-- â”€â”€â”€ Equity Snapshots Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card" style="margin-bottom:16px;">
            <h2>ğŸ“ˆ Equity Timeline (5-min snapshots)</h2>
            <div class="chart-container">
                <canvas id="equity-snapshots-chart"></canvas>
            </div>
        </section>

        <!-- â”€â”€â”€ Market Watchlist â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card" style="margin-bottom:16px;">
            <h2>ğŸ‘ï¸ Market Watchlist</h2>
            <div class="watchlist-actions">
                <input type="text" id="watchlist-market-id" placeholder="Market ID (condition_id)">
                <input type="text" id="watchlist-question" placeholder="Market question / name">
                <button class="btn-watch" onclick="addToWatchlist()">+ Add to Watchlist</button>
            </div>
            <table>
                <thead><tr><th>Market</th><th>Category</th><th>Added</th><th>Notes</th><th></th></tr></thead>
                <tbody id="watchlist-body"><tr><td colspan="5" style="text-align:center;color:var(--text-muted)">No watchlist items</td></tr></tbody>
            </table>
        </section>

        <!-- â”€â”€â”€ Trade Journal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card">
            <h2>ğŸ““ Trade Journal</h2>
            <div id="journal-entries">
                <p style="text-align:center;color:var(--text-muted);padding:24px 0;">No journal entries yet. Entries are auto-created when trades close.</p>
            </div>
        </section>

    </div>
    <!-- TAB 6: ADMIN PANEL                                      -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-admin" data-tab="admin">

        <!-- â”€â”€â”€ Health Score + Quick Actions Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="admin-top-bar">
            <div class="admin-health-gauge-wrap">
                <div class="admin-health-gauge">
                    <svg viewBox="0 0 120 120" class="health-ring">
                        <circle cx="60" cy="60" r="52" class="health-ring-bg"/>
                        <circle cx="60" cy="60" r="52" class="health-ring-fill" id="health-ring-fill"
                                stroke-dasharray="326.7" stroke-dashoffset="326.7"/>
                    </svg>
                    <div class="health-gauge-inner">
                        <div class="health-gauge-score" id="health-gauge-score">â€”</div>
                        <div class="health-gauge-grade" id="health-gauge-grade">â€”</div>
                    </div>
                </div>
                <div class="health-gauge-label">System Health</div>
            </div>
            <div class="admin-quick-actions">
                <button class="btn btn-sm btn-action" onclick="refreshAdminPanel()" title="Refresh all admin data">ğŸ”„ Refresh</button>
                <button class="btn btn-sm btn-action" onclick="adminBackupDB()" title="Create database backup">ğŸ’¾ Backup DB</button>
                <button class="btn btn-sm btn-action" onclick="adminVacuumDB()" title="Compact the database">ğŸ—œï¸ Vacuum</button>
                <button class="btn btn-sm btn-action" onclick="adminClearCache()" title="Clear in-memory cache">ğŸ—‘ï¸ Clear Cache</button>
                <button class="btn btn-sm btn-action" onclick="adminRotateLogs()" title="Rotate log files">ğŸ“œ Rotate Logs</button>
                <button class="btn btn-sm btn-action" onclick="adminResetMetrics()" title="Reset metric counters">ğŸ“Š Reset Metrics</button>
                <button class="btn btn-sm btn-action" onclick="adminTestAlert()" title="Send test alert">ğŸ”” Test Alert</button>
            </div>
        </section>

        <!-- â”€â”€â”€ Health Issues â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="admin-health-issues" id="admin-health-issues" style="display:none;">
            <div class="panel" style="border-left: 3px solid var(--accent-orange);">
                <div class="panel-header"><h2>âš ï¸ Health Issues</h2></div>
                <div id="admin-issues-list"></div>
            </div>
        </section>

        <!-- â”€â”€â”€ System Overview Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="card-grid" id="admin-overview-cards">
            <div class="card accent-blue">
                <div class="card-label">Uptime</div>
                <div class="card-value" id="admin-uptime">â€”</div>
                <div class="card-sub" id="admin-uptime-sub">Since: â€”</div>
            </div>
            <div class="card accent-green">
                <div class="card-label">Engine Cycles</div>
                <div class="card-value" id="admin-cycles">0</div>
                <div class="card-sub" id="admin-cycles-sub">Interval: â€”</div>
            </div>
            <div class="card accent-purple">
                <div class="card-label">Database Size</div>
                <div class="card-value" id="admin-db-size">0 MB</div>
                <div class="card-sub" id="admin-db-rows">Rows: 0</div>
            </div>
            <div class="card accent-orange">
                <div class="card-label">Est. API Cost</div>
                <div class="card-value" id="admin-api-cost">$0.00</div>
                <div class="card-sub" id="admin-api-cost-sub">LLM: $0.00 | Search: $0.00</div>
            </div>
            <div class="card accent-teal">
                <div class="card-label">API Keys</div>
                <div class="card-value" id="admin-keys-count">0 / 0</div>
                <div class="card-sub" id="admin-keys-sub">Configured</div>
            </div>
            <div class="card accent-pink">
                <div class="card-label">Log File</div>
                <div class="card-value" id="admin-log-size">0 MB</div>
                <div class="card-sub" id="admin-log-lines">Lines: 0</div>
            </div>
            <div class="card accent-blue">
                <div class="card-label">Memory (RSS)</div>
                <div class="card-value" id="admin-memory">0 MB</div>
                <div class="card-sub" id="admin-memory-sub">Threads: 0</div>
            </div>
            <div class="card accent-green">
                <div class="card-label">Win / Loss</div>
                <div class="card-value" id="admin-win-loss">0 / 0</div>
                <div class="card-sub" id="admin-win-loss-sub">Neutral: 0</div>
            </div>
        </section>

        <!-- â”€â”€â”€ Cycle Performance Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“‰ Cycle Performance</h2>
                <div class="panel-tools">
                    <span class="badge badge-paper" id="admin-cycle-stats">â€”</span>
                </div>
            </div>
            <div class="chart-container" style="height:220px;">
                <canvas id="admin-cycle-chart"></canvas>
            </div>
        </section>

        <!-- â”€â”€â”€ Engine Health â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ¥ Engine Health</h2>
                <div class="panel-tools">
                    <span class="badge" id="admin-engine-badge">â€”</span>
                </div>
            </div>
            <div class="admin-health-grid" id="admin-engine-health">
                <div class="admin-health-item">
                    <span class="admin-health-label">Status</span>
                    <span class="admin-health-value" id="admin-eh-status">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Thread Alive</span>
                    <span class="admin-health-value" id="admin-eh-thread">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Mode</span>
                    <span class="admin-health-value" id="admin-eh-mode">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Cycle Count</span>
                    <span class="admin-health-value" id="admin-eh-cycles">0</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Cycle Interval</span>
                    <span class="admin-health-value" id="admin-eh-interval">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Last Error</span>
                    <span class="admin-health-value admin-error-text" id="admin-eh-error">None</span>
                </div>
            </div>
        </section>

        <!-- â”€â”€â”€ Risk Monitor (from System) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <h2>âš ï¸ Risk Monitor</h2>
            <div class="risk-grid" id="risk-grid">
                <div class="risk-item">
                    <div class="risk-label">Daily Exposure</div>
                    <div class="risk-bar-container">
                        <div class="risk-bar" id="risk-bar-daily" style="width:0%"></div>
                    </div>
                    <div class="risk-values">
                        <span id="risk-daily-current">$0</span> / <span id="risk-daily-limit">$0</span>
                    </div>
                </div>
                <div class="risk-item">
                    <div class="risk-label">Open Positions</div>
                    <div class="risk-bar-container">
                        <div class="risk-bar" id="risk-bar-positions" style="width:0%"></div>
                    </div>
                    <div class="risk-values">
                        <span id="risk-pos-current">0</span> / <span id="risk-pos-limit">0</span>
                    </div>
                </div>
                <div class="risk-item">
                    <div class="risk-label">Evidence Quality (recent avg)</div>
                    <div class="risk-bar-container">
                        <div class="risk-bar bar-inverted" id="risk-bar-eq" style="width:0%"></div>
                    </div>
                    <div class="risk-values">
                        <span id="risk-eq-current">0.00</span> / min <span id="risk-eq-limit">0.00</span>
                    </div>
                </div>
            </div>
            <div class="risk-params" id="risk-params"></div>
        </section>

        <!-- â”€â”€â”€ API Keys & Credentials â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ”‘ API Keys & Credentials</h2>
                <div class="panel-tools">
                    <span class="badge badge-paper" id="admin-keys-badge">0 / 0 configured</span>
                    <button class="btn btn-sm btn-save" onclick="saveAllEnvVars()" title="Save all key changes">ğŸ’¾ Save Keys</button>
                </div>
            </div>
            <p class="config-hint">Enter your API keys below. Values are stored in <code>.env</code> and loaded at runtime. Some changes require an engine restart.</p>
            <div class="settings-env-grid" id="settings-env-grid">
                <p style="text-align:center;color:var(--text-muted);padding:24px 0;">Loading API keysâ€¦</p>
            </div>
            <div class="admin-keys-grid" id="admin-keys-grid" style="margin-top:16px;"></div>
        </section>

        <!-- â”€â”€â”€ Feature Flags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸš© Feature Flags</h2>
                <div class="panel-tools">
                    <span style="font-size:0.72rem;color:var(--text-dim);">Click toggles to change â€” saves immediately</span>
                </div>
            </div>
            <div class="settings-flags-grid" id="settings-flags-grid">
                <p style="text-align:center;color:var(--text-muted);padding:24px 0;">Loading flagsâ€¦</p>
            </div>
            <div class="admin-flags-grid" id="admin-flags-grid" style="display:none;"></div>
        </section>

        <!-- â”€â”€â”€ Full Configuration Editor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“‹ All Configuration</h2>
                <div class="panel-tools">
                    <button class="btn btn-sm btn-action" onclick="reloadConfigForSettings()">ğŸ”„ Reload</button>
                    <button class="btn btn-sm btn-save" onclick="saveAllConfig()">ğŸ’¾ Save All</button>
                    <button class="btn btn-sm btn-danger" onclick="confirmResetConfig()">ğŸ”ƒ Reset Defaults</button>
                </div>
            </div>
            <p class="config-hint">Edit any value and click <strong>Save</strong> to persist to config.yaml. Changes take effect immediately.</p>
            <div class="config-tabs" id="settings-cfg-tabs"></div>
            <div class="config-grid" id="settings-cfg-grid">
                <p style="text-align:center;color:var(--text-muted);padding:32px 0;">Loading configurationâ€¦</p>
            </div>
            <!-- Legacy config containers for System tab JS compat -->
            <div class="config-tabs" id="config-tabs" style="display:none;"></div>
            <div class="config-grid" id="config-grid" style="display:none;"></div>
        </section>

        <!-- â”€â”€â”€ LLM & API Cost Tracker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ’° API Usage & Cost Tracker</h2>
            </div>
            <div class="card-grid" id="admin-cost-cards">
                <div class="card accent-blue">
                    <div class="card-label">LLM Calls</div>
                    <div class="card-value" id="admin-llm-calls">0</div>
                    <div class="card-sub" id="admin-llm-model">Model: â€”</div>
                </div>
                <div class="card accent-green">
                    <div class="card-label">Total Tokens</div>
                    <div class="card-value" id="admin-total-tokens">0</div>
                    <div class="card-sub" id="admin-tokens-detail">In: 0 | Out: 0</div>
                </div>
                <div class="card accent-orange">
                    <div class="card-label">Search Calls</div>
                    <div class="card-value" id="admin-search-calls">0</div>
                    <div class="card-sub" id="admin-search-cost">Cost: $0.00</div>
                </div>
                <div class="card accent-red" style="border-left-color: var(--accent-red);">
                    <div class="card-label">API Errors</div>
                    <div class="card-value" id="admin-api-errors">0</div>
                    <div class="card-sub">Total errors</div>
                </div>
            </div>
            <!-- Per-API cost breakdown -->
            <div class="admin-cost-breakdown" id="admin-cost-breakdown"></div>
            <!-- Ensemble Models -->
            <div class="admin-ensemble-info" id="admin-ensemble-info"></div>
        </section>

        <!-- â”€â”€â”€ Rate Limiter Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>â±ï¸ Rate Limiter</h2>
            </div>
            <div class="table-wrap">
                <table id="admin-rate-table">
                    <thead><tr>
                        <th>Endpoint</th><th>Total Requests</th><th>Total Waits</th><th>Wait Ratio</th>
                    </tr></thead>
                    <tbody id="admin-rate-body">
                        <tr><td colspan="4" class="empty-state">No rate limiter data</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Trading Activity Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“Š Trading Activity Summary</h2>
            </div>
            <div class="admin-health-grid" id="admin-trading-summary">
                <div class="admin-health-item">
                    <span class="admin-health-label">Total Forecasts</span>
                    <span class="admin-health-value" id="admin-ts-forecasts">0</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Today Forecasts</span>
                    <span class="admin-health-value" id="admin-ts-today-forecasts">0</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Total Trades</span>
                    <span class="admin-health-value" id="admin-ts-trades">0</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Today Trades</span>
                    <span class="admin-health-value" id="admin-ts-today-trades">0</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Avg Candidates/Cycle</span>
                    <span class="admin-health-value" id="admin-ts-avg-cand">0</span>
                </div>
            </div>
            <!-- Hourly Activity Chart -->
            <div class="chart-container" style="height:160px;margin-top:16px;">
                <canvas id="admin-hourly-chart"></canvas>
            </div>
            <!-- Decision Breakdown -->
            <div class="admin-decision-breakdown" id="admin-decision-breakdown"></div>
        </section>

        <!-- â”€â”€â”€ Audit Trail (from System) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ”’ Audit Trail</h2>
                <div class="panel-tools">
                    <input type="text" class="search-input" placeholder="ğŸ” Filter audit..." oninput="filterTable('audit-body', this.value)">
                </div>
            </div>
            <div class="table-wrap">
                <table id="audit-table">
                    <thead><tr>
                        <th>ID</th><th>Market</th><th>Decision</th><th>Stage</th>
                        <th>Details</th><th>Integrity</th><th>Time</th>
                    </tr></thead>
                    <tbody id="audit-body">
                        <tr><td colspan="7" class="empty-state">No audit entries</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Alerts Table (from System) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <h2>ğŸ”” Alerts Table</h2>
            <div class="table-wrap">
                <table id="alerts-table">
                    <thead><tr>
                        <th>Level</th><th>Channel</th><th>Message</th><th>Time</th>
                    </tr></thead>
                    <tbody id="alerts-body">
                        <tr><td colspan="4" class="empty-state">No alerts</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Database Tables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ—„ï¸ Database Tables</h2>
                <div class="panel-tools">
                    <button class="btn btn-muted btn-sm" onclick="adminVacuumDB()">ğŸ—œï¸ Vacuum DB</button>
                    <button class="btn btn-muted btn-sm" onclick="adminClearCache()">ğŸ—‘ï¸ Clear Cache</button>
                </div>
            </div>
            <div class="table-wrap">
                <table id="admin-db-table">
                    <thead><tr>
                        <th>Table</th><th>Row Count</th><th>Bar</th><th>Status</th><th>Export</th>
                    </tr></thead>
                    <tbody id="admin-db-body">
                        <tr><td colspan="5" class="empty-state">Loadingâ€¦</td></tr>
                    </tbody>
                </table>
            </div>
            <!-- DB Pragma Info -->
            <div class="admin-db-pragma" id="admin-db-pragma"></div>
        </section>

        <!-- â”€â”€â”€ Storage Breakdown â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ’¿ Storage Breakdown</h2>
            </div>
            <div class="admin-storage-grid" id="admin-storage-grid"></div>
        </section>

        <!-- â”€â”€â”€ Internal Metrics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“ˆ Internal Metrics</h2>
                <div class="panel-tools">
                    <button class="btn btn-muted btn-sm" onclick="adminResetMetrics()">ğŸ”„ Reset</button>
                </div>
            </div>
            <div class="admin-metrics-section">
                <h3 style="font-size:0.85rem;margin-bottom:8px;">Counters</h3>
                <div class="admin-metrics-grid" id="admin-counters-grid"></div>
            </div>
            <div class="admin-metrics-section" style="margin-top:16px;">
                <h3 style="font-size:0.85rem;margin-bottom:8px;">Gauges</h3>
                <div class="admin-metrics-grid" id="admin-gauges-grid"></div>
            </div>
            <div class="admin-metrics-section" style="margin-top:16px;">
                <h3 style="font-size:0.85rem;margin-bottom:8px;">Histograms</h3>
                <div class="admin-metrics-grid" id="admin-histograms-grid"></div>
            </div>
        </section>

        <!-- â”€â”€â”€ Recent Alerts Feed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ”” Recent Alerts</h2>
                <div class="panel-tools">
                    <select id="admin-alert-filter" class="admin-select" onchange="filterAdminAlerts()">
                        <option value="all">All Levels</option>
                        <option value="info">Info</option>
                        <option value="warning">Warning</option>
                        <option value="error">Error</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
            </div>
            <div class="admin-alerts-feed" id="admin-alerts-feed">
                <div class="empty-state">No alerts recorded</div>
            </div>
        </section>

        <!-- â”€â”€â”€ System Information â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ’» System Information</h2>
            </div>
            <div class="admin-health-grid" id="admin-sys-info">
                <div class="admin-health-item">
                    <span class="admin-health-label">Hostname</span>
                    <span class="admin-health-value" id="admin-sys-hostname">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Platform</span>
                    <span class="admin-health-value" id="admin-sys-platform">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Python</span>
                    <span class="admin-health-value" id="admin-sys-python">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Architecture</span>
                    <span class="admin-health-value" id="admin-sys-arch">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">PID</span>
                    <span class="admin-health-value" id="admin-sys-pid">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">CPU Cores</span>
                    <span class="admin-health-value" id="admin-sys-cpu">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Open FDs</span>
                    <span class="admin-health-value" id="admin-sys-fds">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">DB Path</span>
                    <span class="admin-health-value admin-path-text" id="admin-sys-dbpath">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Config Path</span>
                    <span class="admin-health-value admin-path-text" id="admin-sys-configpath">â€”</span>
                </div>
                <div class="admin-health-item">
                    <span class="admin-health-label">Config Modified</span>
                    <span class="admin-health-value" id="admin-sys-config-mod">â€”</span>
                </div>
            </div>
        </section>

        <!-- â”€â”€â”€ Backup Files â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ’¾ Backup Files</h2>
                <div class="panel-tools">
                    <button class="btn btn-muted btn-sm" onclick="adminBackupDB()">â• Create Backup</button>
                </div>
            </div>
            <div class="table-wrap">
                <table id="admin-backup-table">
                    <thead><tr>
                        <th>Filename</th><th>Size</th><th>Last Modified</th>
                    </tr></thead>
                    <tbody id="admin-backup-body">
                        <tr><td colspan="3" class="empty-state">No backup files found</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- â”€â”€â”€ Recent Log Tail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel">
            <div class="panel-header">
                <h2>ğŸ“œ Recent Log Output</h2>
                <div class="panel-tools">
                    <select id="admin-log-lines-select" class="admin-select" onchange="refreshLogTail()">
                        <option value="50">50 lines</option>
                        <option value="100" selected>100 lines</option>
                        <option value="200">200 lines</option>
                        <option value="500">500 lines</option>
                    </select>
                    <button class="btn btn-muted btn-sm" onclick="refreshLogTail()">ğŸ”„ Refresh</button>
                </div>
            </div>
            <div class="admin-log-stats" id="admin-log-stats"></div>
            <div class="admin-log-viewer" id="admin-log-viewer">
                <pre id="admin-log-content">Loading logâ€¦</pre>
            </div>
        </section>

        <!-- â”€â”€â”€ Danger Zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <section class="panel admin-danger-zone">
            <div class="panel-header">
                <h2>â›” Danger Zone</h2>
            </div>
            <p class="admin-danger-warning">These actions are destructive and cannot be undone. Proceed with extreme caution.</p>
            <div class="admin-danger-grid">
                <div class="admin-danger-card">
                    <div class="admin-danger-info">
                        <strong>Purge Old Data</strong>
                        <span>Delete candidates, alerts, and model logs older than 30 days</span>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="adminPurgeOld()">ğŸ—‘ï¸ Purge</button>
                </div>
                <div class="admin-danger-card">
                    <div class="admin-danger-info">
                        <strong>Rotate Log Files</strong>
                        <span>Archive current log and start fresh</span>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="adminRotateLogs()">ğŸ“œ Rotate</button>
                </div>
                <div class="admin-danger-card">
                    <div class="admin-danger-info">
                        <strong>Reset All Metrics</strong>
                        <span>Clear all in-memory counters, gauges, and histograms</span>
                    </div>
                    <button class="btn btn-danger btn-sm" onclick="adminResetMetrics()">ğŸ“Š Reset</button>
                </div>
            </div>
        </section>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- TAB 7: DOCUMENTATION                                    -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="tab-content" id="tab-docs" data-tab="docs">
        <div class="docs-layout">
            <!-- Sidebar Navigation -->
            <aside class="docs-sidebar" id="docs-sidebar">
                <div class="docs-search-box">
                    <input type="text" id="docs-search" placeholder="Search docsâ€¦" oninput="filterDocs(this.value)">
                </div>
                <nav class="docs-nav">
                    <a class="docs-nav-link active" href="#doc-overview" onclick="scrollToDoc(event,'doc-overview')">Overview</a>
                    <a class="docs-nav-link" href="#doc-architecture" onclick="scrollToDoc(event,'doc-architecture')">Architecture</a>
                    <a class="docs-nav-link" href="#doc-pipeline" onclick="scrollToDoc(event,'doc-pipeline')">Trading Pipeline</a>
                    <a class="docs-nav-link" href="#doc-market-discovery" onclick="scrollToDoc(event,'doc-market-discovery')">Market Discovery</a>
                    <a class="docs-nav-link" href="#doc-research" onclick="scrollToDoc(event,'doc-research')">Research Engine</a>
                    <a class="docs-nav-link" href="#doc-forecasting" onclick="scrollToDoc(event,'doc-forecasting')">Forecasting &amp; Ensemble</a>
                    <a class="docs-nav-link" href="#doc-calibration" onclick="scrollToDoc(event,'doc-calibration')">Calibration</a>
                    <a class="docs-nav-link" href="#doc-edge" onclick="scrollToDoc(event,'doc-edge')">Edge Calculation</a>
                    <a class="docs-nav-link" href="#doc-risk" onclick="scrollToDoc(event,'doc-risk')">Risk Management</a>
                    <a class="docs-nav-link" href="#doc-position-sizing" onclick="scrollToDoc(event,'doc-position-sizing')">Position Sizing</a>
                    <a class="docs-nav-link" href="#doc-drawdown" onclick="scrollToDoc(event,'doc-drawdown')">Drawdown System</a>
                    <a class="docs-nav-link" href="#doc-portfolio" onclick="scrollToDoc(event,'doc-portfolio')">Portfolio Risk</a>
                    <a class="docs-nav-link" href="#doc-execution" onclick="scrollToDoc(event,'doc-execution')">Order Execution</a>
                    <a class="docs-nav-link" href="#doc-engine" onclick="scrollToDoc(event,'doc-engine')">Trading Engine</a>
                    <a class="docs-nav-link" href="#doc-analytics" onclick="scrollToDoc(event,'doc-analytics')">Analytics &amp; Regime</a>
                    <a class="docs-nav-link" href="#doc-whales" onclick="scrollToDoc(event,'doc-whales')">Whale Scanner</a>
                    <a class="docs-nav-link" href="#doc-decision-intel" onclick="scrollToDoc(event,'doc-decision-intel')">Decision Intelligence</a>
                    <a class="docs-nav-link" href="#doc-strategies-wallets" onclick="scrollToDoc(event,'doc-strategies-wallets')">Strategies &amp; Wallets</a>
                    <a class="docs-nav-link" href="#doc-connectors" onclick="scrollToDoc(event,'doc-connectors')">API Connectors</a>
                    <a class="docs-nav-link" href="#doc-storage" onclick="scrollToDoc(event,'doc-storage')">Storage &amp; Database</a>
                    <a class="docs-nav-link" href="#doc-observability" onclick="scrollToDoc(event,'doc-observability')">Observability</a>
                    <a class="docs-nav-link" href="#doc-alerts" onclick="scrollToDoc(event,'doc-alerts')">Alerts &amp; Notifications</a>
                    <a class="docs-nav-link" href="#doc-dashboard-guide" onclick="scrollToDoc(event,'doc-dashboard-guide')">Dashboard Guide</a>
                    <a class="docs-nav-link" href="#doc-configuration" onclick="scrollToDoc(event,'doc-configuration')">Configuration Reference</a>
                    <a class="docs-nav-link" href="#doc-cli" onclick="scrollToDoc(event,'doc-cli')">CLI Commands</a>
                    <a class="docs-nav-link" href="#doc-safety" onclick="scrollToDoc(event,'doc-safety')">Safety &amp; Security</a>
                    <a class="docs-nav-link" href="#doc-deployment" onclick="scrollToDoc(event,'doc-deployment')">Deployment</a>
                    <a class="docs-nav-link" href="#doc-glossary" onclick="scrollToDoc(event,'doc-glossary')">Glossary</a>
                </nav>
            </aside>

            <!-- Main Content -->
            <main class="docs-content" id="docs-content">

                <!-- â”€â”€ OVERVIEW â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-overview">
                    <h1>Polymarket Research &amp; Trading Bot</h1>
                    <p class="docs-version">Version 0.2.0 &middot; MIT License &middot; Python 3.9+</p>
                    <div class="docs-callout docs-callout-info">
                        <strong>What is this?</strong>
                        <p>A production-grade, AI-powered autonomous trading agent for <a href="https://polymarket.com" target="_blank">Polymarket</a> prediction markets. It discovers markets, gathers authoritative evidence from whitelisted sources, generates calibrated probability forecasts using an LLM ensemble, enforces strict risk controls, and executes trades with fractional Kelly sizing.</p>
                    </div>
                    <h3>Key Capabilities</h3>
                    <div class="docs-feature-grid">
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ”</div>
                            <h4>Market Discovery</h4>
                            <p>Auto-scans Polymarket's Gamma API for markets matching volume, liquidity, spread, and category filters.</p>
                        </div>
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ“š</div>
                            <h4>Evidence-Based Research</h4>
                            <p>Fetches sources from whitelisted authoritative domains (bls.gov, sec.gov, etc.) with LLM-powered evidence extraction.</p>
                        </div>
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ§ </div>
                            <h4>Multi-Model Ensemble</h4>
                            <p>Queries GPT-4o, Claude 3.5 Sonnet, and Gemini 1.5 Pro in parallel with adaptive weighting and Platt calibration.</p>
                        </div>
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ›¡ï¸</div>
                            <h4>15-Check Risk Engine</h4>
                            <p>Kill switch, drawdown management, portfolio limits, min edge, evidence quality gates, and more. ALL must pass.</p>
                        </div>
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ“</div>
                            <h4>Kelly Position Sizing</h4>
                            <p>Fractional Kelly criterion with confidence scaling, drawdown heat multiplier, and liquidity-aware caps.</p>
                        </div>
                        <div class="docs-feature-card">
                            <div class="docs-feature-icon">ğŸ‹</div>
                            <h4>Whale Tracking</h4>
                            <p>Monitors top Polymarket leaderboard wallets for smart-money conviction signals to boost or penalize edge.</p>
                        </div>
                    </div>
                </section>

                <!-- â”€â”€ ARCHITECTURE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-architecture">
                    <h2>Architecture</h2>
                    <p>The bot follows a modular pipeline architecture with clear separation of concerns:</p>
                    <div class="docs-code-block">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLI (Click) / Dashboard (Flask)             â”‚
â”‚  scan â”‚ research â”‚ forecast â”‚ paper-trade â”‚ trade â”‚ engine â”‚ dash   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  Connectors          Research             Forecast                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Gamma API    â”‚    â”‚ Query Builder â”‚    â”‚ Feature Builder    â”‚    â”‚
â”‚  â”‚ CLOB API     â”‚â”€â”€â”€â–¶â”‚ Source Fetcherâ”‚â”€â”€â”€â–¶â”‚ LLM Forecaster    â”‚    â”‚
â”‚  â”‚ Web Search   â”‚    â”‚ Evidence Ext. â”‚    â”‚ Ensemble (3 LLMs) â”‚    â”‚
â”‚  â”‚ WebSocket    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Calibrator         â”‚    â”‚
â”‚  â”‚ Rate Limiter â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚                  â”‚
â”‚                                                  â–¼                  â”‚
â”‚  Policy                        Analytics                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Edge Calculator     â”‚       â”‚ Regime Detector          â”‚        â”‚
â”‚  â”‚ Risk Limits (15)    â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚ Calibration Feedback     â”‚        â”‚
â”‚  â”‚ Position Sizer      â”‚       â”‚ Adaptive Model Weights   â”‚        â”‚
â”‚  â”‚ Drawdown Manager    â”‚       â”‚ Smart Entry Calculator   â”‚        â”‚
â”‚  â”‚ Portfolio Risk      â”‚       â”‚ Wallet Scanner           â”‚        â”‚
â”‚  â”‚ Timeline Intel      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚            â”‚                                                        â”‚
â”‚            â–¼                                                        â”‚
â”‚  Execution                     Storage / Observability              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Order Builder        â”‚       â”‚ SQLite + WAL + Migrationsâ”‚        â”‚
â”‚  â”‚ Order Router (dry)   â”‚       â”‚ structlog JSON Logging   â”‚        â”‚
â”‚  â”‚ Fill Tracker         â”‚       â”‚ In-Process Metrics       â”‚        â”‚
â”‚  â”‚ Cancel Manager       â”‚       â”‚ Alerts (Telegram/Slack)  â”‚        â”‚
â”‚  â”‚ TWAP / Iceberg       â”‚       â”‚ JSON Run Reports         â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
                    </div>
                    <h3>Module Map</h3>
                    <table class="docs-table">
                        <thead><tr><th>Package</th><th>Purpose</th><th>Key Files</th></tr></thead>
                        <tbody>
                            <tr><td><code>src/connectors/</code></td><td>External API integrations</td><td>polymarket_gamma.py, polymarket_clob.py, web_search.py, ws_feed.py</td></tr>
                            <tr><td><code>src/research/</code></td><td>Evidence gathering pipeline</td><td>query_builder.py, source_fetcher.py, evidence_extractor.py</td></tr>
                            <tr><td><code>src/forecast/</code></td><td>Probability forecasting</td><td>ensemble.py, llm_forecaster.py, calibrator.py, feature_builder.py</td></tr>
                            <tr><td><code>src/policy/</code></td><td>Risk &amp; sizing decisions</td><td>risk_limits.py, position_sizer.py, edge_calc.py, drawdown.py, portfolio_risk.py</td></tr>
                            <tr><td><code>src/execution/</code></td><td>Order management</td><td>order_builder.py, order_router.py, fill_tracker.py, cancels.py</td></tr>
                            <tr><td><code>src/engine/</code></td><td>Continuous trading loop</td><td>loop.py, market_filter.py, market_classifier.py, event_monitor.py</td></tr>
                            <tr><td><code>src/analytics/</code></td><td>Self-improving analytics</td><td>regime_detector.py, adaptive_weights.py, calibration_feedback.py, smart_entry.py, wallet_scanner.py</td></tr>
                            <tr><td><code>src/storage/</code></td><td>Persistence layer</td><td>database.py, models.py, migrations.py, cache.py, audit.py</td></tr>
                            <tr><td><code>src/observability/</code></td><td>Logging &amp; monitoring</td><td>logger.py, metrics.py, alerts.py, reports.py, sentry_integration.py</td></tr>
                            <tr><td><code>src/dashboard/</code></td><td>Web UI</td><td>app.py, templates/index.html, static/dashboard.js, static/style.css</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- â”€â”€ TRADING PIPELINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-pipeline">
                    <h2>Trading Pipeline</h2>
                    <p>Every trading cycle follows this deterministic pipeline. Each step must succeed for the next to proceed:</p>
                    <div class="docs-pipeline">
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">1</div>
                            <div class="docs-step-body">
                                <h4>Market Discovery</h4>
                                <p>Gamma API scan &rarr; filter by volume, liquidity, spread, category &rarr; classify market type</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">2</div>
                            <div class="docs-step-body">
                                <h4>Research &amp; Evidence Gathering</h4>
                                <p>Build site-restricted queries &rarr; fetch from whitelisted sources &rarr; LLM extracts structured evidence with citations</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">3</div>
                            <div class="docs-step-body">
                                <h4>Feature Engineering</h4>
                                <p>30+ features from market data, orderbook, trade history, and evidence quality scores</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">4</div>
                            <div class="docs-step-body">
                                <h4>LLM Ensemble Forecast</h4>
                                <p>GPT-4o + Claude 3.5 Sonnet + Gemini 1.5 Pro queried in parallel &rarr; trimmed mean aggregation</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">5</div>
                            <div class="docs-step-body">
                                <h4>Calibration</h4>
                                <p>Platt scaling shrinks extremes toward 0.5 &rarr; low-evidence penalty &rarr; contradiction penalty &rarr; historical calibration learning</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">6</div>
                            <div class="docs-step-body">
                                <h4>Edge Calculation</h4>
                                <p>Edge = model_prob &minus; implied_prob &rarr; deduct transaction costs &rarr; determine BUY_YES or BUY_NO direction</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">7</div>
                            <div class="docs-step-body">
                                <h4>Risk Check (15 rules)</h4>
                                <p>Kill switch, drawdown, max stake, daily loss, open positions, min edge, liquidity, spread, evidence quality, confidence, implied prob floor, edge direction, market type, portfolio exposure, timeline</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">8</div>
                            <div class="docs-step-body">
                                <h4>Position Sizing</h4>
                                <p>Fractional Kelly &times; confidence &times; drawdown heat &times; timeline &times; volatility &times; regime &times; category multipliers</p>
                            </div>
                        </div>
                        <div class="docs-pipeline-step">
                            <div class="docs-step-num">9</div>
                            <div class="docs-step-body">
                                <h4>Order Execution</h4>
                                <p>Build limit/market/TWAP/iceberg order &rarr; route through triple dry-run gate &rarr; submit to CLOB or simulate</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- â”€â”€ MARKET DISCOVERY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-market-discovery">
                    <h2>Market Discovery &amp; Classification</h2>
                    <p>The bot discovers markets through Polymarket's Gamma REST API and automatically classifies them by keyword matching.</p>
                    <h3>Scanning Filters</h3>
                    <table class="docs-table">
                        <thead><tr><th>Filter</th><th>Default</th><th>Config Key</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Minimum Volume</td><td>$1,000</td><td><code>scanning.min_volume_usd</code></td><td>Markets below this total volume are skipped</td></tr>
                            <tr><td>Minimum Liquidity</td><td>$500</td><td><code>scanning.min_liquidity_usd</code></td><td>Current available liquidity threshold</td></tr>
                            <tr><td>Maximum Spread</td><td>8%</td><td><code>scanning.max_spread</code></td><td>Markets with wide bid-ask spreads are illiquid</td></tr>
                            <tr><td>Max Days to Expiry</td><td>120</td><td><code>scanning.max_days_to_expiry</code></td><td>Skip markets too far from resolution</td></tr>
                            <tr><td>Batch Size</td><td>100</td><td><code>scanning.batch_size</code></td><td>Markets fetched per API call</td></tr>
                            <tr><td>Research Cooldown</td><td>60 min</td><td><code>scanning.research_cooldown_minutes</code></td><td>Don't re-research the same market within this window</td></tr>
                        </tbody>
                    </table>
                    <h3>Market Type Classification</h3>
                    <p>Markets are classified by matching keywords in the question text:</p>
                    <table class="docs-table">
                        <thead><tr><th>Type</th><th>Example Keywords</th><th>Primary Sources</th></tr></thead>
                        <tbody>
                            <tr><td><span class="docs-badge docs-badge-macro">MACRO</span></td><td>CPI, inflation, GDP, unemployment, Fed, FOMC</td><td>bls.gov, federalreserve.gov, fred.stlouisfed.org</td></tr>
                            <tr><td><span class="docs-badge docs-badge-election">ELECTION</span></td><td>election, vote, president, senate, poll</td><td>fec.gov, ballotpedia.org</td></tr>
                            <tr><td><span class="docs-badge docs-badge-corp">CORPORATE</span></td><td>IPO, earnings, stock, SEC, merger</td><td>sec.gov, investor relations</td></tr>
                            <tr><td><span class="docs-badge docs-badge-weather">WEATHER</span></td><td>hurricane, temperature, NOAA, wildfire</td><td>weather.gov, noaa.gov</td></tr>
                            <tr><td><span class="docs-badge docs-badge-sports">SPORTS</span></td><td>NFL, NBA, Super Bowl, championship</td><td>espn.com, sports-reference.com</td></tr>
                        </tbody>
                    </table>
                    <h3>Pre-Research Filter</h3>
                    <p>Before spending API credits on research, markets are scored (0-100) on volume, liquidity, recency, and category. Markets scoring below <code>filter_min_score</code> (default 25) are skipped. Markets of type <code>UNKNOWN</code> are blocked entirely.</p>
                </section>

                <!-- â”€â”€ RESEARCH ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-research">
                    <h2>Research Engine</h2>
                    <p>The research module implements a <strong>source-first, whitelisted search pipeline</strong> to ensure evidence comes from authoritative sources.</p>
                    <h3>Query Strategy (4 phases)</h3>
                    <div class="docs-ordered-list">
                        <div class="docs-list-item">
                            <span class="docs-list-num">1</span>
                            <div><strong>Site-Restricted Queries</strong> &mdash; Searches primary authoritative domains per market type (e.g., <code>site:bls.gov CPI January 2026</code>)</div>
                        </div>
                        <div class="docs-list-item">
                            <span class="docs-list-num">2</span>
                            <div><strong>Metric-Specific Queries</strong> &mdash; Date-scoped searches for specific data releases and official numbers</div>
                        </div>
                        <div class="docs-list-item">
                            <span class="docs-list-num">3</span>
                            <div><strong>Confirmation Queries</strong> &mdash; Secondary outlets (Reuters, Bloomberg) for corroboration</div>
                        </div>
                        <div class="docs-list-item">
                            <span class="docs-list-num">4</span>
                            <div><strong>Contrarian Queries</strong> &mdash; Deliberately searches for opposing evidence to reduce overconfidence bias</div>
                        </div>
                    </div>
                    <h3>Evidence Extraction</h3>
                    <p>An LLM processes fetched sources to extract structured evidence. Every bullet must include:</p>
                    <div class="docs-code-block">
<pre>{
  "text": "CPI-U increased 3.1% YoY in January 2026",
  "metric_name": "CPI-U YoY",
  "metric_value": "3.1",
  "metric_unit": "percent",
  "metric_date": "2026-01-31",
  "confidence": 0.97,
  "citation": {
    "url": "https://www.bls.gov/...",
    "publisher": "Bureau of Labor Statistics",
    "authority_score": 1.0
  }
}</pre>
                    </div>
                    <h3>Evidence Quality Scoring</h3>
                    <p>Quality is computed independently of LLM self-assessment using:</p>
                    <ul class="docs-ul">
                        <li><strong>Source recency</strong> &mdash; Penalty for stale data (&gt;7 days old, severe &gt;30 days)</li>
                        <li><strong>Domain authority</strong> &mdash; Government sources score 1.0, news outlets 0.6-0.8</li>
                        <li><strong>Cross-source agreement</strong> &mdash; Multiple sources confirming the same metric</li>
                        <li><strong>Numeric density</strong> &mdash; Bonus for evidence with concrete numbers, dates, and units</li>
                        <li><strong>Contradiction detection</strong> &mdash; Conflicting sources reduce confidence</li>
                    </ul>
                    <h3>Search Providers</h3>
                    <table class="docs-table">
                        <thead><tr><th>Provider</th><th>Env Variable</th><th>Notes</th></tr></thead>
                        <tbody>
                            <tr><td>Tavily</td><td><code>TAVILY_API_KEY</code></td><td>Preferred; purpose-built for research agents</td></tr>
                            <tr><td>SerpAPI</td><td><code>SERPAPI_KEY</code></td><td>Google search results</td></tr>
                            <tr><td>Bing</td><td><code>BING_API_KEY</code></td><td>Microsoft Bing search</td></tr>
                            <tr><td>Fallback</td><td>Any available</td><td>Tries each provider in order (default mode)</td></tr>
                        </tbody>
                    </table>
                    <h3>Blocked Domains</h3>
                    <p>The following domains are always excluded: wikipedia.org, reddit.com, medium.com, twitter.com/x.com, quora.com, and other user-generated content sites.</p>
                </section>

                <!-- â”€â”€ FORECASTING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-forecasting">
                    <h2>Forecasting &amp; Ensemble</h2>
                    <p>The forecasting system queries multiple Large Language Models in parallel to produce probability estimates.</p>
                    <h3>Ensemble Architecture</h3>
                    <table class="docs-table">
                        <thead><tr><th>Model</th><th>Provider</th><th>Default Weight</th><th>Env Variable</th></tr></thead>
                        <tbody>
                            <tr><td>GPT-4o</td><td>OpenAI</td><td>40%</td><td><code>OPENAI_API_KEY</code></td></tr>
                            <tr><td>Claude 3.5 Sonnet</td><td>Anthropic</td><td>35%</td><td><code>ANTHROPIC_API_KEY</code></td></tr>
                            <tr><td>Gemini 1.5 Pro</td><td>Google</td><td>25%</td><td><code>GOOGLE_API_KEY</code></td></tr>
                        </tbody>
                    </table>
                    <h3>Aggregation Methods</h3>
                    <ul class="docs-ul">
                        <li><strong>Trimmed Mean</strong> (default) &mdash; Removes the highest and lowest forecasts, averages the rest. Robust to outlier models.</li>
                        <li><strong>Median</strong> &mdash; Takes the middle forecast. Completely resistant to outliers.</li>
                        <li><strong>Weighted</strong> &mdash; Uses per-model weights (static or adaptive). Best when model quality is known.</li>
                    </ul>
                    <h3>Graceful Degradation</h3>
                    <p>If some models fail (API errors, timeouts), the ensemble degrades gracefully. It requires <code>min_models_required</code> (default 1) to succeed. If all models fail, it falls back to a single-model query to <code>fallback_model</code> (default: GPT-4o).</p>
                    <h3>Prompt Structure</h3>
                    <p>Each model receives: the market question, market type, evidence summary, top evidence bullets, contradictions, and market features (volume, spread, implied probability, days to resolution). The model must return a probability (0-1), confidence level (LOW/MEDIUM/HIGH), reasoning, and invalidation triggers.</p>
                    <h3>Adaptive Model Weights</h3>
                    <p>The <code>AdaptiveModelWeighter</code> module tracks per-model, per-category Brier scores from resolved markets. It computes inverse-Brier weights so that models with better track records in a specific category receive more influence. Uses Bayesian smoothing to blend learned weights with priors, requiring 50+ samples for full confidence.</p>
                </section>

                <!-- â”€â”€ CALIBRATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-calibration">
                    <h2>Calibration</h2>
                    <p>Raw LLM probabilities are systematically adjusted for better real-world calibration.</p>
                    <h3>Platt Scaling (Default)</h3>
                    <p>Applies logistic compression with shrinkage toward 0.5. This counteracts the tendency of LLMs to produce overconfident extreme probabilities.</p>
                    <div class="docs-callout docs-callout-math">
                        <strong>Formula:</strong>
                        <p style="font-family:monospace;font-size:1.05em;">calibrated = sigmoid(a &times; logit(raw) + b)</p>
                        <p>Where <code>a &lt; 1</code> provides shrinkage (pulling extremes inward) and <code>b</code> provides a base-rate shift.</p>
                    </div>
                    <h3>Adjustments Applied</h3>
                    <ul class="docs-ul">
                        <li><strong>Shrinkage</strong> &mdash; Extreme probabilities (&gt;0.95 or &lt;0.05) are pulled toward 0.5</li>
                        <li><strong>Low-Evidence Penalty</strong> &mdash; Up to 15% penalty when evidence quality is below threshold</li>
                        <li><strong>Contradiction Penalty</strong> &mdash; Each contradiction reduces confidence proportionally</li>
                        <li><strong>Ensemble Disagreement</strong> &mdash; Wide spread among models triggers additional shrinkage</li>
                    </ul>
                    <h3>Historical Calibration Learning</h3>
                    <p>The <code>CalibrationFeedbackLoop</code> records every (forecast, outcome) pair when markets resolve. After 30+ samples, the bot trains a logistic regression to learn optimal calibration parameters from its own track record, becoming more accurate over time.</p>
                </section>

                <!-- â”€â”€ EDGE CALCULATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-edge">
                    <h2>Edge Calculation</h2>
                    <p>Edge measures the difference between the bot's model probability and the market-implied probability.</p>
                    <div class="docs-callout docs-callout-math">
                        <strong>Core Formula:</strong>
                        <p style="font-family:monospace;font-size:1.05em;">raw_edge = model_probability &minus; implied_probability</p>
                        <p style="font-family:monospace;font-size:1.05em;">net_edge = |raw_edge| &minus; transaction_cost_pct</p>
                    </div>
                    <h3>Direction Logic</h3>
                    <ul class="docs-ul">
                        <li>If <code>model_prob &gt; implied_prob</code> &rarr; <strong>BUY YES</strong> (the market underestimates probability)</li>
                        <li>If <code>model_prob &lt; implied_prob</code> &rarr; <strong>BUY NO</strong> (the market overestimates probability)</li>
                    </ul>
                    <h3>Transaction Costs</h3>
                    <p>Costs include entry fees (<code>transaction_fee_pct</code>, default 2%) and gas costs. The bot uses a hold-to-resolution model (single-leg entry, no exit trade), so only entry costs are deducted.</p>
                    <h3>Expected Value</h3>
                    <p>EV per dollar = (model_prob &times; $1 &minus; cost) / cost. Only positive net-EV trades pass risk checks.</p>
                </section>

                <!-- â”€â”€ RISK MANAGEMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-risk">
                    <h2>Risk Management</h2>
                    <p>The risk engine enforces <strong>15 independent checks</strong>. A trade is only allowed if <strong>ALL</strong> pass. Any single violation blocks the trade.</p>
                    <div class="docs-risk-grid">
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">1</span>
                            <div><strong>Kill Switch</strong><br>Manual global halt; immediately stops all trading</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">2</span>
                            <div><strong>Drawdown Kill</strong><br>Auto-kill when drawdown exceeds max (default 20%)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">3</span>
                            <div><strong>Drawdown Heat</strong><br>Reduces sizing at heat level 2+; blocks at level 3</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">4</span>
                            <div><strong>Max Stake</strong><br>No single trade exceeds max_stake_per_market ($50)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">5</span>
                            <div><strong>Daily Loss Limit</strong><br>Cumulative daily losses capped at max_daily_loss ($500)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">6</span>
                            <div><strong>Open Positions</strong><br>Maximum concurrent positions (default 25)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">7</span>
                            <div><strong>Minimum Edge</strong><br>Net edge after costs must exceed min_edge (default 4%)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">8</span>
                            <div><strong>Min Liquidity</strong><br>Market must have sufficient liquidity ($2,000 default)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">9</span>
                            <div><strong>Max Spread</strong><br>Bid-ask spread must be under max_spread (default 6%)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">10</span>
                            <div><strong>Evidence Quality</strong><br>Must meet min_evidence_quality threshold (default 0.55)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">11</span>
                            <div><strong>Confidence Level</strong><br>Rejects LOW confidence forecasts (requires MEDIUM+)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">12</span>
                            <div><strong>Implied Prob Floor</strong><br>Blocks micro-probability markets (&lt;5% implied)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">13</span>
                            <div><strong>Edge Direction</strong><br>Edge must be positive after costs in the chosen direction</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">14</span>
                            <div><strong>Market Type</strong><br>Market category must be in allowed list (not restricted)</div>
                        </div>
                        <div class="docs-risk-item">
                            <span class="docs-risk-num">15</span>
                            <div><strong>Portfolio Exposure</strong><br>Category and event exposure within portfolio limits</div>
                        </div>
                    </div>
                </section>

                <!-- â”€â”€ POSITION SIZING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-position-sizing">
                    <h2>Position Sizing (Kelly Criterion)</h2>
                    <p>Position sizes are computed using the <strong>fractional Kelly criterion</strong> with multiple adjustment layers.</p>
                    <div class="docs-callout docs-callout-math">
                        <strong>Kelly Formula (Binary Outcome):</strong>
                        <p style="font-family:monospace;font-size:1.05em;">f* = (p &times; b &minus; q) / b</p>
                        <p>Where: p = model probability, q = 1&minus;p, b = odds = (1/cost) &minus; 1</p>
                    </div>
                    <h3>Adjustment Multipliers</h3>
                    <table class="docs-table">
                        <thead><tr><th>Multiplier</th><th>Source</th><th>Range</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td>Kelly Fraction</td><td>Config</td><td>0.25 (quarter-Kelly)</td><td>Reduces full Kelly for real-world variance</td></tr>
                            <tr><td>Confidence</td><td>LLM Forecast</td><td>LOW=0.5, MED=0.75, HIGH=1.0</td><td>Scale by forecast confidence</td></tr>
                            <tr><td>Drawdown Heat</td><td>DrawdownManager</td><td>0.0 &ndash; 1.0</td><td>Reduce sizing during drawdowns</td></tr>
                            <tr><td>Timeline</td><td>TimelineAssessment</td><td>0.5 &ndash; 1.3</td><td>Adjust for resolution timing</td></tr>
                            <tr><td>Volatility</td><td>Market microstructure</td><td>0.0 &ndash; 1.0</td><td>Reduce in volatile markets</td></tr>
                            <tr><td>Regime</td><td>RegimeDetector</td><td>0.5 &ndash; 1.0</td><td>Reduce in HIGH_VOLATILITY regime</td></tr>
                            <tr><td>Category</td><td>Config per-category</td><td>MACRO=1.0, CORP=0.75, ELEC=0.5</td><td>Category-specific risk appetite</td></tr>
                        </tbody>
                    </table>
                    <h3>Caps</h3>
                    <ul class="docs-ul">
                        <li><code>max_stake_per_market</code> &mdash; Hard cap per trade (default $50)</li>
                        <li><code>max_bankroll_fraction</code> &mdash; No trade exceeds 5% of bankroll</li>
                        <li><strong>Liquidity cap</strong> &mdash; Stake capped at 5% of available market liquidity</li>
                    </ul>
                </section>

                <!-- â”€â”€ DRAWDOWN SYSTEM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-drawdown">
                    <h2>Drawdown Management</h2>
                    <p>The drawdown system tracks the equity curve and progressively reduces risk during losing periods.</p>
                    <h3>Heat Levels</h3>
                    <table class="docs-table">
                        <thead><tr><th>Level</th><th>Drawdown %</th><th>Kelly Multiplier</th><th>Action</th></tr></thead>
                        <tbody>
                            <tr><td><span class="docs-heat docs-heat-0">0 (Cool)</span></td><td>&lt;10%</td><td>1.00</td><td>Normal trading</td></tr>
                            <tr><td><span class="docs-heat docs-heat-1">1 (Warning)</span></td><td>10%</td><td>0.50</td><td>Position sizes halved</td></tr>
                            <tr><td><span class="docs-heat docs-heat-2">2 (Critical)</span></td><td>15%</td><td>0.25</td><td>Position sizes quartered</td></tr>
                            <tr><td><span class="docs-heat docs-heat-3">3 (Kill)</span></td><td>20%</td><td>0.00</td><td>All trading halted (kill switch)</td></tr>
                        </tbody>
                    </table>
                    <div class="docs-callout docs-callout-warning">
                        <strong>Auto-Kill Switch:</strong>
                        <p>When <code>auto_kill_at_max: true</code> (default), the bot automatically engages the kill switch at max drawdown. This prevents catastrophic losses but requires manual reset to resume trading.</p>
                    </div>
                </section>

                <!-- â”€â”€ PORTFOLIO RISK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-portfolio">
                    <h2>Portfolio Risk Management</h2>
                    <p>Portfolio-level constraints prevent over-concentration and correlated losses.</p>
                    <table class="docs-table">
                        <thead><tr><th>Constraint</th><th>Default</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Max Category Exposure</td><td>35%</td><td>No single market category can exceed this % of bankroll</td></tr>
                            <tr><td>Max Event Exposure</td><td>25%</td><td>No single event (grouped markets) can exceed this %</td></tr>
                            <tr><td>Max Correlated Positions</td><td>4</td><td>Limit on positions with &gt;70% correlation similarity</td></tr>
                            <tr><td>Category Limits</td><td>MACRO: 40%, ELEC: 35%, CORP: 30%</td><td>Per-category exposure caps</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- â”€â”€ ORDER EXECUTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-execution">
                    <h2>Order Execution</h2>
                    <p>The execution layer builds orders and routes them through safety checks before submission.</p>
                    <h3>Order Types</h3>
                    <ul class="docs-ul">
                        <li><strong>Limit Orders</strong> &mdash; Default; placed at calculated price with TTL (default 300s)</li>
                        <li><strong>Market Orders</strong> &mdash; Immediate fill at current price; used for urgent entries</li>
                        <li><strong>TWAP</strong> &mdash; Time-Weighted Average Price; splits large orders into 5 slices over 30s intervals</li>
                        <li><strong>Iceberg</strong> &mdash; Hides order size; shows only 20% of total, refills as filled. Triggered at $500+ orders</li>
                    </ul>
                    <h3>Triple Dry-Run Gate</h3>
                    <div class="docs-callout docs-callout-danger">
                        <strong>Three independent gates prevent accidental live trading:</strong>
                        <ol style="margin:0.5em 0 0 1.5em;">
                            <li><code>order.dry_run</code> flag on the order object itself</li>
                            <li><code>config.execution.dry_run</code> in config.yaml (default: true)</li>
                            <li><code>ENABLE_LIVE_TRADING</code> environment variable (must be "true")</li>
                        </ol>
                        <p style="margin-top:0.5em;"><strong>ALL THREE</strong> must allow live trading for any order to be submitted to the CLOB.</p>
                    </div>
                    <h3>Smart Entry Timing</h3>
                    <p>The <code>SmartEntryCalculator</code> calculates optimal entry levels using orderbook depth analysis, VWAP divergence, microstructure signals, and momentum. This can improve entry prices by 1-3% (10-30 basis points).</p>
                    <h3>Position Exits</h3>
                    <table class="docs-table">
                        <thead><tr><th>Exit Trigger</th><th>Default</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Stop Loss</td><td>20%</td><td>Exit when position loses 20% of entry value</td></tr>
                            <tr><td>Take Profit</td><td>30%</td><td>Exit when position gains 30%</td></tr>
                            <tr><td>Max Holding Time</td><td>240 hours</td><td>Auto-exit positions held longer than 10 days</td></tr>
                            <tr><td>Resolution / 100%</td><td>N/A</td><td>Exit when market resolves or price reaches 100%</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- â”€â”€ TRADING ENGINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-engine">
                    <h2>Continuous Trading Engine</h2>
                    <p>The engine runs the full pipeline in a loop, coordinating all components autonomously.</p>
                    <h3>Cycle (Default: every 3 minutes)</h3>
                    <div class="docs-ordered-list">
                        <div class="docs-list-item"><span class="docs-list-num">1</span><div>Discover &amp; filter markets from Gamma API</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">2</span><div>Classify and score candidate markets</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">3</span><div>Research top candidates (evidence gathering)</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">4</span><div>Forecast probabilities via LLM ensemble</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">5</span><div>Calculate edges and check risk limits</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">6</span><div>Size positions and build orders</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">7</span><div>Route orders (paper or live)</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">8</span><div>Monitor existing positions for exits</div></div>
                        <div class="docs-list-item"><span class="docs-list-num">9</span><div>Update drawdown state and persist to DB</div></div>
                    </div>
                    <h3>Between Cycles</h3>
                    <ul class="docs-ul">
                        <li>Check drawdown state and heat level</li>
                        <li>Monitor position exits (stop-loss, take-profit, time-based, resolution)</li>
                        <li>Scan whale wallet activity</li>
                        <li>Detect market regime changes</li>
                        <li>Persist engine state to DB for dashboard visibility</li>
                    </ul>
                </section>

                <!-- â”€â”€ ANALYTICS & REGIME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-analytics">
                    <h2>Analytics &amp; Regime Detection</h2>
                    <h3>Market Regime Detector</h3>
                    <p>Adapts strategy based on detected market conditions:</p>
                    <table class="docs-table">
                        <thead><tr><th>Regime</th><th>Detection Signal</th><th>Strategy Adjustment</th></tr></thead>
                        <tbody>
                            <tr><td><strong>NORMAL</strong></td><td>Stable spreads, moderate volume</td><td>Standard parameters</td></tr>
                            <tr><td><strong>TRENDING</strong></td><td>Directional price momentum</td><td>Favor momentum entries</td></tr>
                            <tr><td><strong>MEAN_REVERTING</strong></td><td>Oscillating prices</td><td>Contrarian entries, more patience</td></tr>
                            <tr><td><strong>HIGH_VOLATILITY</strong></td><td>Wide spreads, rapid price swings</td><td>Reduce sizes, raise edge threshold</td></tr>
                            <tr><td><strong>LOW_ACTIVITY</strong></td><td>Low volume, few markets</td><td>Conservative, fewer trades</td></tr>
                        </tbody>
                    </table>
                    <h3>Calibration Feedback Loop</h3>
                    <p>When markets resolve, the bot records (forecast_prob, actual_outcome) pairs and periodically retrains calibration. Per-model accuracy is tracked for adaptive weighting. This creates a <strong>self-improving system</strong> that gets more accurate over time.</p>
                    <h3>Performance Tracking</h3>
                    <p>The analytics module tracks: win rate, Brier score, Sharpe ratio, max drawdown, average edge, P&amp;L by category, accuracy by confidence level, and more.</p>
                </section>

                <!-- â”€â”€ WHALE SCANNER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-whales">
                    <h2>Whale / Smart-Money Scanner</h2>
                    <p>The Whale Tracker is a comprehensive smart-money intelligence system that monitors the top 15 Polymarket leaderboard wallets and generates actionable signals. It provides real-time visibility into what the most profitable traders are doing.</p>

                    <h3>Architecture</h3>
                    <p>The scanner runs on a 15-minute cycle within the bot's main engine loop:</p>
                    <ul class="docs-ul">
                        <li><strong>Phase 1 â€“ Fetch:</strong> Queries positions for all 15 tracked wallets via the Data API (up to 200 positions each)</li>
                        <li><strong>Phase 2 â€“ Score:</strong> Computes a composite quality score (0-100) per wallet based on P&amp;L, win rate, and activity</li>
                        <li><strong>Phase 3 â€“ Delta Detection:</strong> Compares current positions against the previous snapshot to identify new entries, exits, and size changes (&gt;10% threshold)</li>
                        <li><strong>Phase 4 â€“ Conviction Signals:</strong> Groups positions by market+outcome and generates conviction signals where 2+ whales agree</li>
                    </ul>

                    <h3>Smart Money Index (SMI)</h3>
                    <p>A proprietary aggregate indicator (0-100) computed from all active whale signals, weighted by position size:</p>
                    <table class="docs-table">
                        <thead><tr><th>SMI Range</th><th>Interpretation</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><strong>70-100</strong></td><td>Very Bullish</td><td>Strong net positive whale conviction across markets</td></tr>
                            <tr><td><strong>60-70</strong></td><td>Bullish</td><td>Moderate positive bias from smart money</td></tr>
                            <tr><td><strong>40-60</strong></td><td>Neutral</td><td>Mixed signals â€” no clear directional consensus</td></tr>
                            <tr><td><strong>30-40</strong></td><td>Bearish</td><td>Moderate negative bias from smart money</td></tr>
                            <tr><td><strong>0-30</strong></td><td>Very Bearish</td><td>Strong net negative whale conviction</td></tr>
                        </tbody>
                    </table>
                    <div class="docs-callout docs-callout-info">
                        <strong>How SMI is Calculated:</strong>
                        <p>SMI = (Î£ bullish_conviction Ã— position_usd) / (Î£ all_conviction Ã— position_usd) Ã— 100. A value of 50 means equal bullish and bearish conviction-weighted capital.</p>
                    </div>

                    <h3>Conviction Scoring</h3>
                    <p>Each market where 2+ whales hold the same outcome receives a conviction score (0-100):</p>
                    <table class="docs-table">
                        <thead><tr><th>Component</th><th>Weight</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>Whale Count</td><td>25 pts/whale</td><td>More whales on same market = higher conviction</td></tr>
                            <tr><td>Capital Size</td><td>logâ‚â‚€(USD) Ã— 8</td><td>Logarithmic scaling of total whale capital committed</td></tr>
                            <tr><td>Profit Factor</td><td>Up to 15 pts</td><td>Bonus when whales are in profit (entry &lt; current price)</td></tr>
                        </tbody>
                    </table>
                    <p>Signal strength classification:</p>
                    <table class="docs-table">
                        <thead><tr><th>Strength</th><th>Score Range</th><th>Dashboard Badge</th></tr></thead>
                        <tbody>
                            <tr><td>ğŸŸ¢ <strong>STRONG</strong></td><td>â‰¥70</td><td>Green pill â€” highest confidence signals</td></tr>
                            <tr><td>ğŸŸ¡ <strong>MODERATE</strong></td><td>45-69</td><td>Orange pill â€” worth monitoring</td></tr>
                            <tr><td>âšª <strong>WEAK</strong></td><td>30-44</td><td>Gray pill â€” low confidence</td></tr>
                        </tbody>
                    </table>

                    <h3>High Consensus Alerts</h3>
                    <p>When 3+ whales agree on the same market outcome, a "High Consensus Alert" is triggered. These are the strongest smart money signals and appear as highlighted cards in the dashboard. The bot uses these for whale-edge convergence detection.</p>

                    <h3>Net Whale Flow</h3>
                    <p>Tracks aggregate capital entering vs. exiting whale positions:</p>
                    <ul class="docs-ul">
                        <li><strong>Flow In:</strong> Sum of $ from NEW_ENTRY and SIZE_INCREASE deltas</li>
                        <li><strong>Flow Out:</strong> Sum of $ from EXIT and SIZE_DECREASE deltas</li>
                        <li><strong>Net Flow:</strong> Flow In - Flow Out (positive = net accumulation, negative = net distribution)</li>
                    </ul>

                    <h3>Whale Tier System</h3>
                    <p>Each tracked wallet is classified into a performance tier based on total P&amp;L:</p>
                    <table class="docs-table">
                        <thead><tr><th>Tier</th><th>P&amp;L Threshold</th><th>Icon</th></tr></thead>
                        <tbody>
                            <tr><td>ğŸ‘‘ <strong>LEGENDARY</strong></td><td>â‰¥$2M</td><td>Gold crown</td></tr>
                            <tr><td>ğŸ’ <strong>ELITE</strong></td><td>â‰¥$1M</td><td>Purple diamond</td></tr>
                            <tr><td>â­ <strong>PRO</strong></td><td>â‰¥$500K</td><td>Blue star</td></tr>
                            <tr><td>ğŸŒ± <strong>RISING</strong></td><td>&lt;$500K</td><td>Green seedling</td></tr>
                        </tbody>
                    </table>

                    <h3>Delta Detection</h3>
                    <p>Position changes tracked between scan cycles:</p>
                    <table class="docs-table">
                        <thead><tr><th>Action</th><th>Trigger</th><th>Feed Icon</th></tr></thead>
                        <tbody>
                            <tr><td><strong>NEW_ENTRY</strong></td><td>Position appears for first time</td><td>ğŸŸ¢</td></tr>
                            <tr><td><strong>EXIT</strong></td><td>Position disappears from snapshot</td><td>ğŸ”´</td></tr>
                            <tr><td><strong>SIZE_INCREASE</strong></td><td>Position size grows &gt;10%</td><td>ğŸ“ˆ</td></tr>
                            <tr><td><strong>SIZE_DECREASE</strong></td><td>Position size shrinks &gt;10%</td><td>ğŸ“‰</td></tr>
                        </tbody>
                    </table>

                    <h3>Dashboard Components</h3>
                    <p>The Whale Tracker tab includes:</p>
                    <ul class="docs-ul">
                        <li><strong>6 KPI Cards:</strong> Tracked Wallets, Conviction Signals, Smart Money Index, Net Whale Flow, Avg Win Rate, Top Conviction</li>
                        <li><strong>SMI Gauge:</strong> Visual gauge showing bullish/bearish sentiment with animated fill</li>
                        <li><strong>Flow Breakdown:</strong> Bar chart of entry/exit/increase/decrease activity</li>
                        <li><strong>Direction Distribution:</strong> Doughnut chart (bullish vs bearish signals)</li>
                        <li><strong>Top Markets by Whale Capital:</strong> Horizontal bar chart of most concentrated markets</li>
                        <li><strong>High Consensus Alerts:</strong> Highlighted cards for 3+ whale agreement</li>
                        <li><strong>Conviction Signals Table:</strong> Filterable table with conviction progress bars</li>
                        <li><strong>Live Activity Feed:</strong> Styled event feed of whale moves with icons</li>
                        <li><strong>Whale Leaderboard:</strong> Card-based leaderboard with tiers, scores, and activity counts</li>
                    </ul>

                    <h3>Edge Integration</h3>
                    <table class="docs-table">
                        <thead><tr><th>Scenario</th><th>Adjustment</th><th>Default</th></tr></thead>
                        <tbody>
                            <tr><td>Whales agree with model</td><td>Edge boost</td><td>+8%</td></tr>
                            <tr><td>Whales disagree with model</td><td>Edge penalty</td><td>&minus;2%</td></tr>
                            <tr><td>Whale + model convergence</td><td>Lower min_edge</td><td>Down to 2%</td></tr>
                        </tbody>
                    </table>
                    <div class="docs-callout docs-callout-info">
                        <strong>Tracked Wallets:</strong>
                        <p>The scanner monitors 15 wallets scraped from Polymarket's leaderboard, with combined P&amp;L exceeding $18M. Wallet list is defined in <code>wallet_scanner.py</code> and can be customized.</p>
                    </div>

                    <h3>Database Tables</h3>
                    <table class="docs-table">
                        <thead><tr><th>Table</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td><code>tracked_wallets</code></td><td>Wallet metadata: address, name, P&amp;L, win rate, score</td></tr>
                            <tr><td><code>wallet_signals</code></td><td>Conviction signals per market+outcome (unique constraint)</td></tr>
                            <tr><td><code>wallet_deltas</code></td><td>Position change events (entries, exits, size changes)</td></tr>
                        </tbody>
                    </table>

                    <h3>API Endpoint</h3>
                    <div class="docs-code-block">
                        <code>GET /api/whale-activity</code>
                    </div>
                    <p>Returns: <code>tracked_wallets</code>, <code>conviction_signals</code>, <code>recent_deltas</code>, <code>high_consensus_signals</code>, <code>top_markets</code>, and <code>summary</code> (including SMI, net flow, direction distribution, action breakdown, tier enrichment).</p>
                </section>

                <!-- â”€â”€ DECISION INTELLIGENCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-decision-intel">
                    <h2>Decision Intelligence Log</h2>
                    <p>A comprehensive audit trail of every decision the engine makes, from market scanning through trade execution. Provides full transparency into the AI's reasoning process.</p>

                    <h3>What Gets Logged</h3>
                    <ul class="docs-ul">
                        <li><strong>SCAN:</strong> Market discovery and initial filtering decisions</li>
                        <li><strong>RESEARCH:</strong> Evidence gathering, source quality, query construction</li>
                        <li><strong>FORECAST:</strong> Probability estimates from individual models and the ensemble</li>
                        <li><strong>EDGE:</strong> Edge calculations â€” market price vs. forecast probability</li>
                        <li><strong>RISK:</strong> Risk check passes/failures (drawdown, exposure, position limits)</li>
                        <li><strong>SIZE:</strong> Position sizing decisions (Kelly fraction, scaling)</li>
                        <li><strong>EXECUTE:</strong> Order submission, fill tracking, simulated execution</li>
                        <li><strong>MONITOR:</strong> Position monitoring, TP/SL proximity, exit triggers</li>
                    </ul>

                    <h3>Dashboard Tab Features</h3>
                    <ul class="docs-ul">
                        <li>Real-time feed of all decisions with timestamps</li>
                        <li>Color-coded decision types (TRADE, NO_TRADE, SKIP, ERROR)</li>
                        <li>Filter by stage (SCAN, RESEARCH, FORECAST, etc.)</li>
                        <li>Search across all decision fields</li>
                        <li>Integrity verification via SHA-256 hashes</li>
                        <li>Summary cards: total decisions, trade rate, top categories</li>
                    </ul>

                    <h3>API Endpoint</h3>
                    <div class="docs-code-block">
                        <code>GET /api/decision-log</code>
                    </div>
                    <p>Returns: <code>entries</code> (decision records with id, market_id, decision, stage, details, integrity_hash, timestamp), <code>summary</code> (total, by_stage breakdown, by_decision breakdown, recent_rate).</p>

                    <h3>Data Integrity</h3>
                    <p>Each decision entry includes a SHA-256 <code>integrity_hash</code> computed from the decision data, ensuring the audit trail cannot be tampered with. The dashboard shows a âœ… indicator for verified entries.</p>
                </section>

                <!-- â”€â”€ STRATEGIES & WALLETS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-strategies-wallets">
                    <h2>Strategies &amp; Wallets</h2>
                    <p>A portfolio management system for organizing trading activity across multiple wallets and strategies, enabling multi-strategy allocation and performance tracking.</p>

                    <h3>Core Concepts</h3>
                    <table class="docs-table">
                        <thead><tr><th>Concept</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><strong>Wallet</strong></td><td>A funding source with a name, address (optional), initial balance, and P&amp;L tracking</td></tr>
                            <tr><td><strong>Strategy</strong></td><td>A named trading approach (e.g., "AI Trading", "Momentum", "Arbitrage") with its own risk parameters and description</td></tr>
                            <tr><td><strong>Binding</strong></td><td>A many-to-many link between strategies and wallets, controlling how capital is allocated across approaches</td></tr>
                        </tbody>
                    </table>

                    <h3>Database Tables</h3>
                    <table class="docs-table">
                        <thead><tr><th>Table</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td><code>wallets</code></td><td>Wallet metadata: name, address, balance, P&amp;L, status, created/updated timestamps</td></tr>
                            <tr><td><code>strategies</code></td><td>Strategy definitions: name, description, type, risk level, status</td></tr>
                            <tr><td><code>strategy_wallets</code></td><td>Many-to-many binding with allocation percentage per pair</td></tr>
                            <tr><td><code>wallet_trades</code></td><td>Trade records linked to specific wallets</td></tr>
                            <tr><td><code>wallet_equity_snapshots</code></td><td>Point-in-time equity snapshots for equity curve charting</td></tr>
                        </tbody>
                    </table>

                    <h3>API Endpoints</h3>
                    <table class="docs-table">
                        <thead><tr><th>Method</th><th>Endpoint</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td>GET</td><td><code>/api/strategies-overview</code></td><td>Full overview: wallets, strategies, bindings, summary stats</td></tr>
                            <tr><td>POST</td><td><code>/api/wallets</code></td><td>Create a new wallet</td></tr>
                            <tr><td>PUT</td><td><code>/api/wallets/&lt;id&gt;</code></td><td>Update wallet (name, balance, status)</td></tr>
                            <tr><td>DELETE</td><td><code>/api/wallets/&lt;id&gt;</code></td><td>Delete a wallet</td></tr>
                            <tr><td>POST</td><td><code>/api/strategies</code></td><td>Create a new strategy</td></tr>
                            <tr><td>PUT</td><td><code>/api/strategies/&lt;id&gt;</code></td><td>Update strategy details</td></tr>
                            <tr><td>DELETE</td><td><code>/api/strategies/&lt;id&gt;</code></td><td>Delete a strategy</td></tr>
                            <tr><td>POST</td><td><code>/api/strategy-wallets/bind</code></td><td>Bind a strategy to a wallet with allocation %</td></tr>
                            <tr><td>DELETE</td><td><code>/api/strategy-wallets/unbind</code></td><td>Unbind a strategy from a wallet</td></tr>
                        </tbody>
                    </table>

                    <h3>Dashboard Tab</h3>
                    <p>The Strategies tab provides a visual interface to:</p>
                    <ul class="docs-ul">
                        <li>View all wallets with balance, P&amp;L, status, and linked strategies</li>
                        <li>View all strategies with risk levels, descriptions, and linked wallets</li>
                        <li>Create, edit, and delete wallets and strategies via modal dialogs</li>
                        <li>Bind/unbind strategies to wallets with allocation percentages</li>
                        <li>Summary cards showing total capital, active wallets, total P&amp;L, and average allocation</li>
                    </ul>
                </section>

                <!-- â”€â”€ API CONNECTORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-connectors">
                    <h2>API Connectors</h2>
                    <h3>Gamma API (Market Discovery)</h3>
                    <p>The <code>GammaClient</code> connects to Polymarket's public market-listing API at <code>https://gamma-api.polymarket.com</code>. Used for: listing markets, fetching metadata (question, category, end date, resolution source), and getting pricing snapshots.</p>
                    <h3>CLOB API (Orderbook &amp; Trading)</h3>
                    <p>The <code>CLOBClient</code> connects to <code>https://clob.polymarket.com</code> for real-time orderbook data (bids/asks), trade history, spread calculations, and order placement via the <code>py-clob-client</code> signing library.</p>
                    <h3>WebSocket Feed</h3>
                    <p>The <code>WebSocketFeed</code> subscribes to real-time price ticks for monitored markets, providing live data for the dashboard and microstructure analysis.</p>
                    <h3>Rate Limiter</h3>
                    <p>A global rate limiter prevents API abuse with configurable per-endpoint limits and automatic backoff on 429 responses.</p>
                </section>

                <!-- â”€â”€ STORAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-storage">
                    <h2>Storage &amp; Database</h2>
                    <p>All data is persisted in a SQLite database with WAL (Write-Ahead Logging) mode for concurrent reads.</p>
                    <h3>Tables</h3>
                    <table class="docs-table">
                        <thead><tr><th>Table</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td><code>markets</code></td><td>Discovered market metadata (question, type, volume, liquidity)</td></tr>
                            <tr><td><code>forecasts</code></td><td>All forecast results (probabilities, confidence, evidence quality)</td></tr>
                            <tr><td><code>trades</code></td><td>Executed and simulated trade records</td></tr>
                            <tr><td><code>positions</code></td><td>Open positions with entry price and current value</td></tr>
                            <tr><td><code>closed_positions</code></td><td>Realized P&amp;L with close reason (TP hit, SL hit, resolved, time exit)</td></tr>
                            <tr><td><code>performance_log</code></td><td>Per-trade performance data for analytics</td></tr>
                            <tr><td><code>calibration_history</code></td><td>Forecast vs. outcome pairs for calibration learning</td></tr>
                            <tr><td><code>model_forecast_log</code></td><td>Per-model forecasts for adaptive weighting</td></tr>
                            <tr><td><code>audit_log</code></td><td>Admin actions and configuration changes</td></tr>
                            <tr><td><code>whale_scans</code></td><td>Wallet scanner results and conviction signals</td></tr>
                            <tr><td><code>tracked_wallets</code></td><td>Whale tracker wallet metadata and scores</td></tr>
                            <tr><td><code>wallet_signals</code></td><td>Per-market conviction signals from whale wallets</td></tr>
                            <tr><td><code>wallet_deltas</code></td><td>Position change events (entries, exits, size changes)</td></tr>
                            <tr><td><code>decision_log</code></td><td>Decision intelligence audit trail with integrity hashes</td></tr>
                            <tr><td><code>wallets</code></td><td>Strategy wallet definitions (name, address, balance, P&amp;L)</td></tr>
                            <tr><td><code>strategies</code></td><td>Named trading strategies with risk parameters</td></tr>
                            <tr><td><code>strategy_wallets</code></td><td>Many-to-many strategyâ†”wallet bindings with allocation %</td></tr>
                            <tr><td><code>wallet_trades</code></td><td>Trade records linked to specific strategy wallets</td></tr>
                            <tr><td><code>wallet_equity_snapshots</code></td><td>Point-in-time equity snapshots for performance tracking</td></tr>
                        </tbody>
                    </table>
                    <h3>Migrations</h3>
                    <p>Schema is managed through numbered migrations (currently 10). Migrations run automatically on startup, ensuring the database schema stays in sync with the code. Each migration is idempotent and includes proper error handling.</p>
                    <h3>Backup</h3>
                    <p>Database backups can be triggered from the Admin Panel. Backups are stored as timestamped copies in the <code>data/</code> directory.</p>
                </section>

                <!-- â”€â”€ OBSERVABILITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-observability">
                    <h2>Observability</h2>
                    <h3>Structured Logging (structlog)</h3>
                    <p>All logs use JSON-structured format via <code>structlog</code>. Sensitive data (API keys, private keys) is automatically redacted by a custom log processor. Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL.</p>
                    <h3>In-Process Metrics</h3>
                    <p>The <code>metrics</code> module tracks counters, gauges, and histograms in-memory:</p>
                    <ul class="docs-ul">
                        <li><code>orders.simulated</code>, <code>orders.submitted</code>, <code>orders.filled</code></li>
                        <li><code>forecasts.total</code>, <code>forecasts.trade</code>, <code>forecasts.no_trade</code></li>
                        <li><code>risk.violations</code>, <code>risk.kills</code></li>
                        <li><code>api.calls</code>, <code>api.errors</code>, <code>api.latency_ms</code></li>
                    </ul>
                    <h3>Cost Tracking</h3>
                    <p>LLM and search API costs are tracked per-provider with running totals visible in the Admin Panel. Includes token counts and estimated USD costs for OpenAI, Anthropic, Google, and search providers.</p>
                    <h3>JSON Run Reports</h3>
                    <p>Each engine cycle produces a JSON report saved to <code>reports/</code> with full pipeline details.</p>
                    <h3>Sentry Integration</h3>
                    <p>Optional error tracking via Sentry SDK. Configure with <code>SENTRY_DSN</code> environment variable.</p>
                </section>

                <!-- â”€â”€ ALERTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-alerts">
                    <h2>Alerts &amp; Notifications</h2>
                    <p>Multi-channel alerting for critical events:</p>
                    <table class="docs-table">
                        <thead><tr><th>Channel</th><th>Config Keys</th></tr></thead>
                        <tbody>
                            <tr><td>Console</td><td>Always enabled</td></tr>
                            <tr><td>Telegram</td><td><code>alerts.telegram_bot_token</code>, <code>alerts.telegram_chat_id</code></td></tr>
                            <tr><td>Discord</td><td><code>alerts.discord_webhook_url</code></td></tr>
                            <tr><td>Slack</td><td><code>alerts.slack_webhook_url</code></td></tr>
                            <tr><td>Email</td><td><code>alerts.email_smtp_host/port/user/password</code></td></tr>
                        </tbody>
                    </table>
                    <h3>Alert Triggers</h3>
                    <ul class="docs-ul">
                        <li>Trade executions (paper and live)</li>
                        <li>Large P&amp;L moves</li>
                        <li>Drawdown warnings and kill switch activations</li>
                        <li>Risk limit breaches</li>
                        <li>System errors</li>
                        <li>Daily summary (configurable hour, default 6pm)</li>
                    </ul>
                </section>

                <!-- â”€â”€ DASHBOARD GUIDE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-dashboard-guide">
                    <h2>Dashboard Guide</h2>
                    <p>The web dashboard provides a real-time view of all bot operations, accessible at <code>http://localhost:2345</code>.</p>
                    <h3>Tabs Overview</h3>
                    <table class="docs-table">
                        <thead><tr><th>Tab</th><th>Contents</th></tr></thead>
                        <tbody>
                            <tr><td><strong>Overview</strong></td><td>Portfolio summary cards, equity curve, engine status, drawdown gauge, regime indicator</td></tr>
                            <tr><td><strong>Trading</strong></td><td>Open positions with live P&amp;L, pipeline candidates, recent forecasts, enhanced trade history with TP/SL hit tracking, close reasons, duration, PnL%, and summary stats</td></tr>
                            <tr><td><strong>Analytics</strong></td><td>Performance metrics (Sharpe, Sortino, Calmar), accuracy charts, P&amp;L by category, strategy leaderboard</td></tr>
                            <tr><td><strong>Whale Tracker</strong></td><td>Tracked wallets with tiering, conviction signals, whale activity feed, Smart Money Index, consensus analysis</td></tr>
                            <tr><td><strong>Decision Intel</strong></td><td>Full decision audit trail â€” every stage (SCANâ†’RESEARCHâ†’FORECASTâ†’EDGEâ†’RISKâ†’SIZEâ†’EXECUTEâ†’MONITOR) with filtering, search, and integrity hashes</td></tr>
                            <tr><td><strong>Strategies</strong></td><td>Multi-wallet/strategy portfolio management â€” create wallets &amp; strategies, bind them together, track allocation percentages and per-strategy performance</td></tr>
                            <tr><td><strong>Journal</strong></td><td>VaR calculations, watchlist, trade journal entries, equity snapshots</td></tr>
                            <tr><td><strong>Admin Panel</strong></td><td>Engine health, risk monitor, API keys, feature flags, config editor, audit trail, alerts, database stats, system info, danger zone actions</td></tr>
                            <tr><td><strong>Documentation</strong></td><td>This page â€” complete bot reference with 28 sections</td></tr>
                        </tbody>
                    </table>
                    <h3>Authentication</h3>
                    <p>Set <code>DASHBOARD_API_KEY</code> in your <code>.env</code> file. Access the dashboard with the API key as a header (<code>X-API-Key</code>) or query parameter (<code>?api_key=...</code>). If no key is set, the dashboard runs in open-access mode.</p>
                    <h3>Auto-Refresh</h3>
                    <p>The dashboard auto-refreshes every 15 seconds, but only fetches data for the currently active tab to minimize API load.</p>
                </section>

                <!-- â”€â”€ CONFIGURATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-configuration">
                    <h2>Configuration Reference</h2>
                    <p>All configuration is managed via <code>config.yaml</code> with environment variable overrides. The dashboard Admin Panel provides a visual config editor.</p>
                    <table class="docs-table docs-table-config">
                        <thead><tr><th>Section</th><th>Key Settings</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><code>scanning</code></td><td>min_volume_usd, min_liquidity_usd, max_spread, preferred_types, restricted_types</td><td>Market discovery filters</td></tr>
                            <tr><td><code>research</code></td><td>max_sources, search_provider, min_corroborating_sources, stale_days_penalty</td><td>Evidence gathering settings</td></tr>
                            <tr><td><code>forecasting</code></td><td>llm_model, llm_temperature, min_evidence_quality, min_confidence_level</td><td>LLM forecasting parameters</td></tr>
                            <tr><td><code>ensemble</code></td><td>models, aggregation, weights, min_models_required, timeout_per_model_secs</td><td>Multi-model ensemble config</td></tr>
                            <tr><td><code>risk</code></td><td>max_stake_per_market, max_daily_loss, min_edge, kelly_fraction, bankroll, stop_loss_pct</td><td>Risk management thresholds</td></tr>
                            <tr><td><code>drawdown</code></td><td>max_drawdown_pct, warning/critical thresholds, auto_kill_at_max</td><td>Drawdown heat system</td></tr>
                            <tr><td><code>portfolio</code></td><td>max_category_exposure_pct, max_single_event_exposure_pct, max_correlated_positions</td><td>Portfolio-level risk limits</td></tr>
                            <tr><td><code>timeline</code></td><td>near_resolution_hours, confidence_boost, exit_before_resolution_hours</td><td>Resolution timing adjustments</td></tr>
                            <tr><td><code>microstructure</code></td><td>whale_size_threshold_usd, flow_imbalance_windows, depth_change_alert_pct</td><td>Market microstructure analysis</td></tr>
                            <tr><td><code>execution</code></td><td>dry_run, slippage_tolerance, twap_enabled, iceberg_threshold, adaptive_pricing</td><td>Order execution settings</td></tr>
                            <tr><td><code>engine</code></td><td>cycle_interval_secs, max_markets_per_cycle, paper_mode, auto_start</td><td>Trading engine loop settings</td></tr>
                            <tr><td><code>alerts</code></td><td>telegram/discord/slack/email credentials, alert triggers, daily_summary_hour</td><td>Notification channels</td></tr>
                            <tr><td><code>wallet_scanner</code></td><td>scan_interval, min_conviction_score, conviction_edge_boost/penalty</td><td>Whale tracking config</td></tr>
                            <tr><td><code>cache</code></td><td>search_ttl_secs, orderbook_ttl_secs, max_cache_size_mb</td><td>Response caching</td></tr>
                            <tr><td><code>storage</code></td><td>db_type, sqlite_path</td><td>Database settings</td></tr>
                            <tr><td><code>observability</code></td><td>log_level, log_format, log_file, enable_metrics</td><td>Logging and monitoring</td></tr>
                        </tbody>
                    </table>
                </section>

                <!-- â”€â”€ CLI COMMANDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-cli">
                    <h2>CLI Commands</h2>
                    <p>The bot is controlled via the <code>bot</code> CLI (Click-based). Entry point: <code>src.cli:cli</code>.</p>
                    <table class="docs-table">
                        <thead><tr><th>Command</th><th>Description</th><th>Key Flags</th></tr></thead>
                        <tbody>
                            <tr><td><code>bot scan</code></td><td>Discover active markets from Gamma API</td><td><code>--limit N</code></td></tr>
                            <tr><td><code>bot research --market ID</code></td><td>Gather sources &amp; extract evidence</td><td></td></tr>
                            <tr><td><code>bot forecast --market ID</code></td><td>Full pipeline: research &rarr; forecast &rarr; risk &rarr; size</td><td></td></tr>
                            <tr><td><code>bot paper-trade</code></td><td>Run paper trading simulation</td><td><code>--days N</code>, <code>--markets N</code></td></tr>
                            <tr><td><code>bot trade --live</code></td><td>Live trading (requires ENABLE_LIVE_TRADING)</td><td><code>--live</code> (required)</td></tr>
                            <tr><td><code>bot engine start</code></td><td>Start the continuous trading engine</td><td></td></tr>
                            <tr><td><code>bot engine status</code></td><td>Show engine status summary</td><td></td></tr>
                            <tr><td><code>bot portfolio</code></td><td>Show portfolio risk report</td><td></td></tr>
                            <tr><td><code>bot drawdown</code></td><td>Show drawdown state</td><td></td></tr>
                            <tr><td><code>bot arbitrage</code></td><td>Scan for arbitrage opportunities</td><td><code>--limit N</code></td></tr>
                            <tr><td><code>bot alerts</code></td><td>Show recent alerts</td><td><code>--limit N</code></td></tr>
                            <tr><td><code>bot dashboard</code></td><td>Launch web dashboard</td><td><code>--host</code>, <code>--port</code>, <code>--debug</code></td></tr>
                        </tbody>
                    </table>
                    <h3>Quick Start</h3>
                    <div class="docs-code-block">
<pre># Install
git clone &lt;repo-url&gt; polymarket-bot
cd polymarket-bot
python -m venv .venv &amp;&amp; source .venv/bin/activate
pip install -e ".[dev]"

# Configure
cp .env.example .env
# Edit .env with API keys: OPENAI_API_KEY, TAVILY_API_KEY, etc.

# Run
bot scan --limit 20                    # Discover markets
bot forecast --market &lt;CONDITION_ID&gt;   # Full forecast pipeline
bot dashboard                          # Launch web UI on :2345</pre>
                    </div>
                </section>

                <!-- â”€â”€ SAFETY & SECURITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-safety">
                    <h2>Safety &amp; Security</h2>
                    <div class="docs-callout docs-callout-danger">
                        <strong>This bot trades real money.</strong>
                        <p>Always start with <code>dry_run: true</code> (default) and thoroughly test with <code>paper-trade</code> before enabling live trading.</p>
                    </div>
                    <h3>Safety Mechanisms</h3>
                    <ul class="docs-ul">
                        <li><strong>Triple dry-run gate</strong> &mdash; Three independent flags must all allow live trading</li>
                        <li><strong>Kill switch</strong> &mdash; Instant halt, accessible from CLI, config, and dashboard</li>
                        <li><strong>Auto-kill on max drawdown</strong> &mdash; Prevents catastrophic losses</li>
                        <li><strong>15 independent risk checks</strong> &mdash; All must pass for any trade</li>
                        <li><strong>Position limits</strong> &mdash; Per-trade, per-category, and portfolio-wide caps</li>
                    </ul>
                    <h3>Security Practices</h3>
                    <ul class="docs-ul">
                        <li><strong>API keys</strong> loaded from environment only, never committed to code</li>
                        <li><strong>Private keys</strong> automatically redacted in structlog output</li>
                        <li><strong>Dashboard auth</strong> via API key header or query parameter</li>
                        <li><strong>Docker</strong> &mdash; Runs as non-root user in container</li>
                        <li><strong>Audit trail</strong> &mdash; All admin actions and config changes logged to database</li>
                    </ul>
                </section>

                <!-- â”€â”€ DEPLOYMENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-deployment">
                    <h2>Deployment</h2>
                    <h3>Local Development</h3>
                    <div class="docs-code-block">
<pre>python -m venv .venv
source .venv/bin/activate
pip install -e ".[dev]"
bot dashboard</pre>
                    </div>
                    <h3>Docker</h3>
                    <div class="docs-code-block">
<pre>docker compose build
docker compose up -d          # Runs dashboard + engine
docker compose logs -f        # Follow logs</pre>
                    </div>
                    <h3>Environment Variables</h3>
                    <table class="docs-table">
                        <thead><tr><th>Variable</th><th>Required</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><code>OPENAI_API_KEY</code></td><td>Yes</td><td>GPT-4o forecasting</td></tr>
                            <tr><td><code>ANTHROPIC_API_KEY</code></td><td>Recommended</td><td>Claude 3.5 Sonnet (ensemble)</td></tr>
                            <tr><td><code>GOOGLE_API_KEY</code></td><td>Recommended</td><td>Gemini 1.5 Pro (ensemble)</td></tr>
                            <tr><td><code>TAVILY_API_KEY</code></td><td>Yes*</td><td>Web search provider (*or SERPAPI_KEY or BING_API_KEY)</td></tr>
                            <tr><td><code>POLYMARKET_API_KEY</code></td><td>For live trading</td><td>Polymarket CLOB API credentials</td></tr>
                            <tr><td><code>POLYMARKET_API_SECRET</code></td><td>For live trading</td><td>CLOB API secret</td></tr>
                            <tr><td><code>POLYMARKET_PASSPHRASE</code></td><td>For live trading</td><td>CLOB API passphrase</td></tr>
                            <tr><td><code>ENABLE_LIVE_TRADING</code></td><td>No</td><td>Must be "true" to allow live orders</td></tr>
                            <tr><td><code>DASHBOARD_API_KEY</code></td><td>No</td><td>Protects dashboard access</td></tr>
                            <tr><td><code>SENTRY_DSN</code></td><td>No</td><td>Sentry error tracking</td></tr>
                        </tbody>
                    </table>
                    <h3>Testing</h3>
                    <div class="docs-code-block">
<pre>pytest                                   # Run all tests
pytest --cov=src --cov-report=term       # With coverage
pytest tests/test_policy.py -v           # Specific test file
mypy src/                                # Type checking
ruff check src/ tests/                   # Linting</pre>
                    </div>
                </section>

                <!-- â”€â”€ GLOSSARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                <section class="docs-section" id="doc-glossary">
                    <h2>Glossary</h2>
                    <table class="docs-table">
                        <thead><tr><th>Term</th><th>Definition</th></tr></thead>
                        <tbody>
                            <tr><td><strong>Edge</strong></td><td>The difference between model probability and market-implied probability; the bot's informational advantage.</td></tr>
                            <tr><td><strong>Implied Probability</strong></td><td>The probability implied by the current market price (best bid or mid-point).</td></tr>
                            <tr><td><strong>Kelly Criterion</strong></td><td>A mathematical formula for optimal bet sizing that maximizes long-term bankroll growth.</td></tr>
                            <tr><td><strong>Fractional Kelly</strong></td><td>Using a fraction (e.g., 25%) of full Kelly to reduce variance at the cost of slightly lower expected growth.</td></tr>
                            <tr><td><strong>Drawdown</strong></td><td>The percentage decline from peak equity; measures how much has been lost from the highest point.</td></tr>
                            <tr><td><strong>Heat Level</strong></td><td>A 0-3 scale representing drawdown severity; higher levels reduce position sizes and may halt trading.</td></tr>
                            <tr><td><strong>Brier Score</strong></td><td>A calibration metric: mean squared error between predicted probabilities and outcomes. Lower is better (0 = perfect).</td></tr>
                            <tr><td><strong>Platt Scaling</strong></td><td>A calibration technique using logistic regression to adjust raw probabilities for better real-world accuracy.</td></tr>
                            <tr><td><strong>CLOB</strong></td><td>Central Limit Order Book; Polymarket's orderbook for matching trades.</td></tr>
                            <tr><td><strong>Gamma API</strong></td><td>Polymarket's public REST API for market metadata and discovery.</td></tr>
                            <tr><td><strong>TWAP</strong></td><td>Time-Weighted Average Price; splits a large order into smaller slices executed over time.</td></tr>
                            <tr><td><strong>Iceberg Order</strong></td><td>An order that hides its full size, showing only a fraction to the market at a time.</td></tr>
                            <tr><td><strong>Kill Switch</strong></td><td>An emergency mechanism that immediately halts all trading activity.</td></tr>
                            <tr><td><strong>Conviction Score</strong></td><td>A whale tracking metric measuring how strongly top traders agree on a market direction.</td></tr>
                            <tr><td><strong>WAL</strong></td><td>Write-Ahead Logging; a SQLite journal mode that allows concurrent reads during writes.</td></tr>
                            <tr><td><strong>Paper Mode</strong></td><td>Simulation mode where all trades are recorded but no real orders are placed.</td></tr>
                        </tbody>
                    </table>
                </section>

                <div class="docs-footer">
                    <p>Polymarket Research &amp; Trading Bot v0.2.0 &middot; Built with Python, Flask, SQLite, and GPT-4o/Claude/Gemini</p>
                </div>

            </main>
        </div>
    </div>

    <!-- â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <footer>
        <span>Polymarket Research & Trading Bot â€” Dashboard</span>
        <span>Auto-refreshes every 15s</span>
    </footer>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!--  MODAL OVERLAY (shared by all modals)                      -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="wm-overlay" id="wm-overlay" onclick="closeWhaleModal(event)">

        <!-- â”€â”€â”€ Whale Profile Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="wm-modal wm-modal-large" id="wm-whale-profile" onclick="event.stopPropagation()">
            <div class="wm-header">
                <div class="wm-header-left">
                    <button class="wm-star-btn" id="wm-whale-star" onclick="toggleWhaleStar()" title="Star this whale">â˜†</button>
                    <h2 id="wm-whale-name">Whale Profile</h2>
                    <span class="wm-tier-badge" id="wm-whale-tier"></span>
                </div>
                <button class="wm-close" onclick="closeWhaleModal()">&times;</button>
            </div>

            <!-- Tabs -->
            <div class="wm-tabs">
                <button class="wm-tab active" onclick="switchWhaleProfileTab('overview')">ğŸ“Š Overview</button>
                <button class="wm-tab" onclick="switchWhaleProfileTab('positions')">ğŸ¯ Positions</button>
                <button class="wm-tab" onclick="switchWhaleProfileTab('activity')">ğŸ“¡ Activity</button>
                <button class="wm-tab" onclick="switchWhaleProfileTab('backtest')">ğŸ“ˆ Back-Analysis</button>
                <button class="wm-tab" onclick="switchWhaleProfileTab('mentor')">ğŸ¤– Strategy Mentor</button>
            </div>

            <!-- Tab: Overview -->
            <div class="wm-tab-content active" id="wm-wp-overview">
                <div class="wm-kpi-row" id="wm-whale-kpis"></div>
                <div class="wm-whale-address-row" id="wm-whale-address"></div>
                <div class="wm-card wm-live-stats-card" id="wm-whale-live-stats" style="display:none;"></div>
                <div class="wm-two-col">
                    <div class="wm-card">
                        <h3>ğŸ¯ Direction Split</h3>
                        <div class="wm-direction-bar" id="wm-whale-direction"></div>
                    </div>
                    <div class="wm-card">
                        <h3>ğŸ·ï¸ Category Distribution</h3>
                        <div id="wm-whale-categories"></div>
                    </div>
                </div>
                <div class="wm-card">
                    <h3>ğŸ”ï¸ Top Markets</h3>
                    <div id="wm-whale-top-markets"></div>
                </div>
            </div>

            <!-- Tab: Positions -->
            <div class="wm-tab-content" id="wm-wp-positions">
                <div class="wm-table-scroll">
                    <table class="wm-table">
                        <thead><tr><th>Market</th><th>Outcome</th><th>Direction</th><th>Capital</th><th>Conviction</th><th>Price</th></tr></thead>
                        <tbody id="wm-whale-signals-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- Tab: Activity -->
            <div class="wm-tab-content" id="wm-wp-activity">
                <div class="wm-feed" id="wm-whale-activity-feed"></div>
            </div>

            <!-- Tab: Back-Analysis -->
            <div class="wm-tab-content" id="wm-wp-backtest">
                <div class="wm-backtest-header" id="wm-backtest-header"></div>
                <div class="wm-backtest-chart" id="wm-backtest-chart"></div>
                <div class="wm-backtest-table" id="wm-backtest-table"></div>
            </div>

            <!-- Tab: Strategy Mentor Chat -->
            <div class="wm-tab-content" id="wm-wp-mentor">
                <div class="wm-mentor-wrap">
                    <div class="wm-mentor-messages" id="wm-mentor-messages">
                        <div class="wm-mentor-welcome">
                            <div class="wm-mentor-avatar">ğŸ¤–</div>
                            <p>I'm your <strong>Strategy Mentor</strong>. I can analyze this whale's trading patterns, identify strategies, and provide actionable insights.</p>
                            <p class="wm-mentor-suggestions">Try asking:</p>
                            <div class="wm-mentor-chips">
                                <button class="wm-chip" onclick="sendMentorChip(this)">What's their trading strategy?</button>
                                <button class="wm-chip" onclick="sendMentorChip(this)">Are they accumulating or distributing?</button>
                                <button class="wm-chip" onclick="sendMentorChip(this)">What are their best and worst positions?</button>
                                <button class="wm-chip" onclick="sendMentorChip(this)">Should I follow their trades?</button>
                            </div>
                        </div>
                    </div>
                    <div class="wm-mentor-input-row">
                        <input type="text" class="wm-mentor-input" id="wm-mentor-input" placeholder="Ask the Strategy Mentorâ€¦" onkeydown="if(event.key==='Enter')sendMentorMessage()">
                        <button class="wm-mentor-send" onclick="sendMentorMessage()">Send â¤</button>
                        <button class="wm-mentor-clear" onclick="clearMentorChat()" title="Clear history">ğŸ—‘ï¸</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- â”€â”€â”€ Market Detail Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="wm-modal wm-modal-medium" id="wm-market-detail" onclick="event.stopPropagation()">
            <div class="wm-header">
                <div class="wm-header-left">
                    <button class="wm-star-btn" id="wm-market-star" onclick="toggleMarketStar()" title="Star this market">â˜†</button>
                    <h2 id="wm-market-title">Market Detail</h2>
                </div>
                <button class="wm-close" onclick="closeWhaleModal()">&times;</button>
            </div>
            <div class="wm-market-link-row" id="wm-market-links"></div>
            <div class="wm-kpi-row" id="wm-market-kpis"></div>
            <div class="wm-card">
                <h3>ğŸ‹ Whale Signals</h3>
                <div class="wm-table-scroll">
                    <table class="wm-table">
                        <thead><tr><th>Outcome</th><th>Whales</th><th>Capital</th><th>Conviction</th><th>Direction</th><th>Price</th></tr></thead>
                        <tbody id="wm-market-signals-body"></tbody>
                    </table>
                </div>
            </div>
            <div class="wm-card">
                <h3>ğŸ“¡ Recent Activity</h3>
                <div class="wm-feed" id="wm-market-activity-feed"></div>
            </div>
        </div>

        <!-- â”€â”€â”€ Activity Detail Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="wm-modal wm-modal-small" id="wm-activity-detail" onclick="event.stopPropagation()">
            <div class="wm-header">
                <h2>ğŸ“¡ Activity Detail</h2>
                <button class="wm-close" onclick="closeWhaleModal()">&times;</button>
            </div>
            <div id="wm-activity-content"></div>
        </div>

    </div>

    <script src="/static/dashboard.js?v=38"></script>
</body>
</html>
